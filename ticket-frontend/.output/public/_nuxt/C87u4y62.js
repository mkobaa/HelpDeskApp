import{_ as U,a as y,b as C}from"./Ddr_hDuZ.js";import{_ as k}from"./D3QffkNq.js";import{_ as S}from"./CFZJElYW.js";import{a0 as j}from"./GPD3P-m0.js";import{Y as B,g as N,P,z as h,a4 as R,k as $,w as n,a2 as v,o as D,b as a,a as u,v as I,d as x}from"./BGim2kwq.js";import"./kDLvYEi9.js";import"./CCraGg39.js";import"./K8s1tnq0.js";const T=async({username:f,email:e,password:p,role:l,department:c})=>{let r=B("auth_token").value||"";try{r=decodeURIComponent(r)}catch{}if(l&&!["user","technician","supervisor","admin"].includes(l))throw new Error("Invalid role. Allowed roles: user, technician, supervisor, admin");const i=await fetch("http://localhost:8000/api/users",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({username:f,email:e,password:p,role:l,department:c})}),d=await i.json();if(!i.ok)throw d;return d},q={class:"flex flex-col flex-1 gap-6 p-6 overflow-auto"},A={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},F={class:"flex justify-end gap-3 pt-2"},K=N({__name:"create",setup(f){const e=P({username:"",email:"",password:"",role:"",department:""}),p=h(["user","technician","supervisor","admin"]),l=h(!1),c=R(),_=async()=>{if(!l.value){l.value=!0;try{await T({username:e.username,email:e.email,password:e.password,role:e.role||void 0,department:e.department||void 0}),await c.push("/admin/users")}catch(r){console.error("Failed to create user",r)}finally{l.value=!1}}};return(r,o)=>{const i=y,d=C,m=k,s=v("UFormGroup"),b=S,w=j,g=v("UDashboardPage"),V=U;return D(),$(V,null,{default:n(()=>[a(i),a(g,{class:"flex flex-col flex-1 min-w-0 overflow-hidden"},{default:n(()=>[a(d,{title:"Create user",icon:"i-lucide-user-plus",class:"w-full"}),u("div",q,[u("form",{class:"flex flex-col gap-4 max-w-3xl w-full",onSubmit:I(_,["prevent"])},[u("div",A,[a(s,{label:"Username",name:"username"},{default:n(()=>[a(m,{modelValue:e.username,"onUpdate:modelValue":o[0]||(o[0]=t=>e.username=t),placeholder:"jane.doe",required:"",maxlength:"255"},null,8,["modelValue"])]),_:1}),a(s,{label:"Email",name:"email"},{default:n(()=>[a(m,{modelValue:e.email,"onUpdate:modelValue":o[1]||(o[1]=t=>e.email=t),type:"email",placeholder:"jane@example.com",required:"",maxlength:"255"},null,8,["modelValue"])]),_:1})]),a(s,{label:"Password",name:"password"},{default:n(()=>[a(m,{modelValue:e.password,"onUpdate:modelValue":o[2]||(o[2]=t=>e.password=t),type:"password",placeholder:"min 8 characters",required:"",minlength:"8"},null,8,["modelValue"])]),_:1}),a(s,{label:"Role (optional)",name:"role"},{default:n(()=>[a(b,{modelValue:e.role,"onUpdate:modelValue":o[3]||(o[3]=t=>e.role=t),items:p.value,placeholder:"Select role"},null,8,["modelValue","items"])]),_:1}),a(s,{label:"Department (optional)",name:"department"},{default:n(()=>[a(m,{modelValue:e.department,"onUpdate:modelValue":o[4]||(o[4]=t=>e.department=t),placeholder:"IT Support",maxlength:"255"},null,8,["modelValue"])]),_:1}),u("div",F,[a(w,{color:"neutral",variant:"ghost",to:"/admin/users"},{default:n(()=>[...o[5]||(o[5]=[x("Cancel",-1)])]),_:1}),a(w,{loading:l.value,disabled:l.value,type:"submit",color:"primary",icon:"i-lucide-check"},{default:n(()=>[...o[6]||(o[6]=[x("Create",-1)])]),_:1},8,["loading","disabled"])])],32)])]),_:1})]),_:1})}}});export{K as default};
