import{_ as q,a as H,b as M}from"./Ddr_hDuZ.js";import{a0 as O}from"./GPD3P-m0.js";import{_ as J}from"./D3QffkNq.js";import{_ as L}from"./CFZJElYW.js";import{_ as Y}from"./RuDiqTgZ.js";import{Y as K,g as Q,a3 as W,a4 as X,e as Z,z as D,P as ee,$ as P,h as te,a5 as ae,k as oe,w as i,a2 as k,o as f,b as o,a,f as d,d as g,t as y,c as x,p as S,v as se}from"./BGim2kwq.js";import{g as ne,a as $}from"./CsvkjaTc.js";import{u as A}from"./RmwAmyau.js";import"./kDLvYEi9.js";import"./K8s1tnq0.js";import"./CCraGg39.js";const ie=async(U,{name:l,description:c,parent_category_id:h})=>{let n=K("auth_token").value||"";try{n=decodeURIComponent(n)}catch{}const r=await fetch(`http://localhost:8000/api/categories/${U}`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({name:l,description:c,parent_category_id:h})}),t=await r.json();if(!r.ok)throw t;return t?.data||t},le={class:"flex flex-col flex-1 gap-6 p-6 overflow-auto"},re={class:"flex items-center justify-between gap-3"},de={class:"flex items-center justify-between"},ce={key:0,class:"text-xs text-muted"},ue={key:0,class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},me={class:"text-sm text-highlighted"},pe={class:"text-sm text-highlighted"},_e={class:"text-sm text-highlighted"},fe={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},ge={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},ve={class:"flex justify-end gap-3 pt-2"},ye={key:2,class:"mt-4 text-sm text-error"},xe={class:"flex gap-3"},Ae=Q({__name:"[id]",async setup(U){let l,c;const h=W();X();const u=Z(()=>h.params.id),n=D(!1),r=D(!1),t=ee({name:"",description:"",parent_category_id:null}),{data:s,status:B,error:j,refresh:b}=([l,c]=P(()=>A(()=>`category-${u.value}`,()=>ne(u.value),{server:!1,lazy:!1,immediate:!0,watch:[u]})),l=await l,c(),l);te(()=>b()),ae(()=>{s.value&&(t.name=s.value.name??"",t.description=s.value.description??"",t.parent_category_id=s.value.parent_category_id??null)});const V=()=>{n.value=!n.value,n.value||s.value&&(t.name=s.value.name||"",t.description=s.value.description||"",t.parent_category_id=s.value.parent_category_id||"")},{data:he}=([l,c]=P(()=>A("categories",()=>$(),{server:!1})),l=await l,c(),l),z=async(v="")=>{const e=await $(v),C=Array.isArray(e)?e:Array.isArray(e.data)?e.data:[];return[{label:"None",value:null},...C.filter(m=>m.id!==Number(u.value)).map(m=>({label:m.name,value:m.id}))]},E=async()=>{if(!r.value){r.value=!0;try{await ie(u.value,{name:t.name,description:t.description,parent_category_id:t.parent_category_id}),await b(),n.value=!1}catch(v){console.error("Failed to update category",v)}finally{r.value=!1}}};return(v,e)=>{const C=H,m=M,F=k("UDashboardPageHeader"),p=O,N=J,w=k("UFormGroup"),R=L,G=Y,I=k("UDashboardPage"),T=q;return f(),oe(T,null,{default:i(()=>[o(C),o(I,{class:"flex flex-col flex-1 min-w-0 overflow-hidden"},{default:i(()=>[o(m,{title:"Category details",icon:"i-lucide-folder",class:"w-full"}),a("div",le,[a("div",re,[o(F,{title:d(s)?.name||"Category details",description:d(s)?.description||""},null,8,["title","description"]),o(p,{size:"sm",icon:n.value?"i-lucide-x":"i-lucide-pencil",color:n.value?"neutral":"primary",onClick:V},{default:i(()=>[g(y(n.value?"Cancel":"Edit"),1)]),_:1},8,["icon","color"])]),o(G,null,{header:i(()=>[a("div",de,[e[3]||(e[3]=a("p",{class:"text-sm font-semibold text-highlighted"},"Profile",-1)),d(B)==="pending"?(f(),x("div",ce,"Loading...")):S("",!0)])]),default:i(()=>[n.value?(f(),x("form",{key:1,class:"flex flex-col gap-4",onSubmit:se(E,["prevent"])},[a("div",fe,[o(w,{label:"Name",name:"name"},{default:i(()=>[o(N,{modelValue:t.name,"onUpdate:modelValue":e[0]||(e[0]=_=>t.name=_),required:"",maxlength:"255"},null,8,["modelValue"])]),_:1}),o(w,{label:"Description",name:"description"},{default:i(()=>[o(N,{modelValue:t.description,"onUpdate:modelValue":e[1]||(e[1]=_=>t.description=_),required:"",maxlength:"255"},null,8,["modelValue"])]),_:1})]),a("div",ge,[o(w,{label:"Parent Category",name:"parent_category_id"},{default:i(()=>[o(R,{modelValue:t.parent_category_id,"onUpdate:modelValue":e[2]||(e[2]=_=>t.parent_category_id=_),options:z,placeholder:"Select parent category",searchable:"",clearable:""},null,8,["modelValue"])]),_:1})]),a("div",ve,[o(p,{type:"button",color:"neutral",variant:"ghost",onClick:V},{default:i(()=>[...e[7]||(e[7]=[g("Cancel",-1)])]),_:1}),o(p,{type:"submit",color:"primary",icon:"i-lucide-check",loading:r.value,disabled:r.value},{default:i(()=>[...e[8]||(e[8]=[g(" Save Changes ",-1)])]),_:1},8,["loading","disabled"])])],32)):(f(),x("div",ue,[a("div",null,[e[4]||(e[4]=a("p",{class:"text-xs text-muted"},"Name",-1)),a("p",me,y(d(s)?.name||"—"),1)]),a("div",null,[e[5]||(e[5]=a("p",{class:"text-xs text-muted"},"Description",-1)),a("p",pe,y(d(s)?.description||"—"),1)]),a("div",null,[e[6]||(e[6]=a("p",{class:"text-xs text-muted"},"Parent Category",-1)),a("p",_e,y(d(s)?.parent?.name||"—"),1)])])),d(j)?(f(),x("div",ye,"Failed to load user.")):S("",!0)]),_:1}),a("div",xe,[o(p,{color:"neutral",variant:"ghost",to:"/admin/users"},{default:i(()=>[...e[9]||(e[9]=[g("Back to list",-1)])]),_:1}),o(p,{size:"sm",icon:"i-lucide-refresh-ccw",variant:"outline",onClick:d(b)},{default:i(()=>[...e[10]||(e[10]=[g("Refresh",-1)])]),_:1},8,["onClick"])])])]),_:1})]),_:1})}}});export{Ae as default};
