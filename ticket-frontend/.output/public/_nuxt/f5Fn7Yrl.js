import{c as V,_ as z,a as R,b as j}from"./Ddr_hDuZ.js";import{_ as E}from"./RuDiqTgZ.js";import{c as L}from"./BbY_nosd.js";import{a0 as H}from"./GPD3P-m0.js";import{_ as G}from"./CvGMUJgZ.js";import{b as D}from"./B6rNHc4N.js";import{u as M}from"./RmwAmyau.js";import{g as B,$ as O,e as N,Y,a1 as q,k as C,o as h,f as w,w as o,a as e,b as n,d as U,t as g,L as I,a3 as F,a4 as J,z as x,P as Q,h as W,l as X,a2 as K,c as P,p as $}from"./BGim2kwq.js";import"./kDLvYEi9.js";import"./K8s1tnq0.js";import"./DYcZGXPK.js";const Z={class:"flex gap-2"},ee={class:"flex items-center"},te={class:"flex items-center"},se=B({__name:"TechnicianTickets",props:{technicianId:{},filters:{}},async setup(A){let c,d;const u=A,m=[{accessorKey:"id",header:"ID"},{accessorKey:"title",header:"Title"},{accessorKey:"description",header:"Description"},{accessorKey:"status",header:"Status"},{accessorKey:"priority",header:"Priority"},{accessorKey:"category.name",header:"Category"},{accessorKey:"created_at",header:"Created At"},{accessorKey:"actions",header:"Actions"}],{data:t,status:p,refresh:v}=([c,d]=O(()=>M("tickets",()=>u.technicianId?D(u.technicianId):D(""),{watch:[()=>u.filters,()=>u.technicianId],server:!1,lazy:!1,default:()=>[]})),c=await c,d(),c),y=N(()=>t.value?Array.isArray(t.value)?t.value:t.value.data&&Array.isArray(t.value.data)?t.value.data:t.value.data&&t.value.data.data&&Array.isArray(t.value.data.data)?t.value.data.data:[]:[]),a=r=>({low:"bg-green-100 text-green-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-orange-100 text-orange-800",critical:"bg-red-100 text-red-800"})[String(r)]||"bg-gray-50 text-gray-700",s=r=>({open:"bg-green-100 text-green-800",in_progress:"bg-yellow-100 text-yellow-800",pending:"bg-orange-100 text-orange-800",resolved:"bg-blue-100 text-blue-800",closed:"bg-gray-100 text-gray-600"})[String(r)]||"bg-gray-50 text-gray-700",b=r=>r?r==="in_progress"?"In Progress":String(r).replace(/_/g," ").replace(/\b\w/g,i=>i.toUpperCase()):"",f=Y("role");let _="";return f.value==="technician"?_="/technician/tickets/":f.value==="supervisor"?_="/supervisor/tickets/":f.value==="user"&&(_="/user/tickets/"),q(()=>{v()}),(r,i)=>{const k=H,T=V,S=G;return h(),C(S,{data:w(y),columns:m,loading:w(p)==="pending"},{"actions-cell":o(({row:l})=>[e("div",Z,[n(k,{size:"xs",color:"primary",variant:"soft",icon:"i-lucide-eye",to:`${w(_)}${l.original.id}`},{default:o(()=>[...i[0]||(i[0]=[U(" View ",-1)])]),_:1},8,["to"])])]),"status-cell":o(({row:l})=>[e("div",ee,[n(T,{color:"neutral",variant:"soft",class:I(`${s(l.original.status)} px-2 py-1 text-xs font-semibold`)},{default:o(()=>[U(g(b(l.original.status)),1)]),_:2},1032,["class"])])]),"priority-cell":o(({row:l})=>[e("div",te,[n(T,{color:"neutral",variant:"soft",class:I(`${a(l.original.priority)} px-2 py-1 text-xs font-semibold`)},{default:o(()=>[U(g(b(l.original.priority)),1)]),_:2},1032,["class"])])]),_:1},8,["data","loading"])}}}),ae=Object.assign(se,{__name:"TechnicianTickets"}),re={class:"flex flex-col flex-1 gap-6 p-6 overflow-auto"},oe={class:"flex items-center justify-between gap-3"},ie={class:"flex items-center justify-between"},ne={key:0,class:"text-xs text-muted"},le={key:0,class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},ce={class:"text-sm text-highlighted"},de={class:"text-sm text-highlighted"},ue={class:"text-sm text-highlighted"},me={class:"text-sm text-highlighted"},pe={class:"mt-6"},$e=B({__name:"[id]",setup(A){const c=F();J();const d=N(()=>c.params.id),u=x(!1);x(!1);const m=Q({username:"",email:"",password:"",role:"",department:""}),t=x(null),p=x("idle"),v=x(null),y=async()=>{if(d.value){p.value="pending",v.value=null;try{const a=await L(d.value);t.value=a,m.username=a?.username||"",m.email=a?.email||"",m.role=a?.role||"",m.department=a?.department||"",p.value="success"}catch(a){v.value=a,p.value="error"}}};return W(()=>y()),X(d,(a,s)=>{a&&a!==s&&y()}),(a,s)=>{const b=R,f=j,_=K("UDashboardPageHeader"),r=E,i=K("UDashboardPage"),k=z;return h(),C(k,null,{default:o(()=>[n(b),n(i,{class:"flex flex-col flex-1 min-w-0 overflow-hidden"},{default:o(()=>[n(f,{title:"User details",icon:"i-lucide-user",class:"w-full"}),e("div",re,[e("div",oe,[n(_,{title:t.value?.username||"User",description:t.value?.email||""},null,8,["title","description"])]),n(r,null,{header:o(()=>[e("div",ie,[s[0]||(s[0]=e("p",{class:"text-sm font-semibold text-highlighted"},"Profile",-1)),p.value==="pending"?(h(),P("div",ne,"Loading...")):$("",!0)])]),default:o(()=>[u.value?$("",!0):(h(),P("div",le,[e("div",null,[s[1]||(s[1]=e("p",{class:"text-xs text-muted"},"Username",-1)),e("p",ce,g(t.value?.username||"—"),1)]),e("div",null,[s[2]||(s[2]=e("p",{class:"text-xs text-muted"},"Email",-1)),e("p",de,g(t.value?.email||"—"),1)]),e("div",null,[s[3]||(s[3]=e("p",{class:"text-xs text-muted"},"Role",-1)),e("p",ue,g(t.value?.role||"—"),1)]),e("div",null,[s[4]||(s[4]=e("p",{class:"text-xs text-muted"},"Department",-1)),e("p",me,g(t.value?.department||"—"),1)])]))]),_:1}),e("div",pe,[s[5]||(s[5]=e("p",{class:"text-sm font-semibold text-highlighted mb-2"},"Assigned Tickets",-1)),t.value?.id?(h(),C(ae,{key:0,technicianId:t.value.id},null,8,["technicianId"])):$("",!0)])])]),_:1})]),_:1})}}});export{$e as default};
