import { _ as _sfc_main$e, a as __nuxt_component_1, b as __nuxt_component_2, c as _sfc_main$6, i as isPending } from './navbar-DByaTdfk.mjs';
import { b as _sfc_main$1 } from './usePortal-BKdXuyUd.mjs';
import { _ as _sfc_main$2 } from './Card-o7xn3WFg.mjs';
import { _ as _sfc_main$3 } from './Select-Dv6KDMrI.mjs';
import { _ as _sfc_main$4 } from './Alert-D75idXAT.mjs';
import { defineComponent, computed, ref, reactive, withAsyncContext, watchEffect, watch, resolveComponent, withCtx, unref, createTextVNode, toDisplayString, isRef, createVNode, createBlock, openBlock, Fragment, createCommentVNode, renderList, useSSRContext } from 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/vue/index.mjs';
import { ssrRenderComponent, ssrInterpolate, ssrRenderClass, ssrRenderList, ssrRenderAttr } from 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/vue/server-renderer/index.mjs';
import { g as getTicketById } from './tickets-BxG6Zsyw.mjs';
import { _ as __nuxt_component_7, u as updateTicketStatus } from './updateTicketStatus-Da378j06.mjs';
import { b as getTechnicians } from './users-DRTWlAv4.mjs';
import { d as useRoute, b as useCookie } from './server.mjs';
import { u as useAsyncData } from './index-Db0gMLsE.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/reka-ui/dist/index.js';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/defu/dist/defu.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/@vueuse/core/dist/index.js';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/vaul-vue/dist/index.js';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/reka-ui/dist/namespaced/index.mjs';
import './nuxt-link-Bj7IzWuU.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/ufo/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/ohash/dist/utils/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/tailwind-variants/dist/index.js';
import './Input-u_sFkXpR.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/ofetch/dist/node.mjs';
import '../nitro/nitro.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/h3/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/destr/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/hookable/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/node-mock-http/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/unstorage/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/unstorage/drivers/fs.mjs';
import 'node:crypto';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/unstorage/drivers/fs-lite.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/unstorage/drivers/lru-cache.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/ohash/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/klona/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/scule/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/unctx/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/radix3/dist/index.mjs';
import 'node:fs';
import 'node:url';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/pathe/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/@iconify/utils/lib/index.js';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/consola/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/vue-router/vue-router.node.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/nuxt/node_modules/cookie-es/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/tailwindcss/dist/colors.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/@iconify/vue/dist/iconify.mjs';
import '../_/renderer.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/vue-bundle-renderer/dist/runtime.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/unhead/dist/server.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/devalue/index.js';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/unhead/dist/utils.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/@iconify/utils/lib/css/icon.js';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/perfect-debounce/dist/index.mjs';

const assignTechnician = async (ticketId, technicianId) => {
  if (!ticketId) throw new Error("Ticket id is required");
  const token = useCookie("auth_token");
  let bearer = token.value || "";
  try {
    bearer = decodeURIComponent(bearer);
  } catch {
  }
  const url = `http://localhost:8000/api/tickets/${encodeURIComponent(ticketId)}/assign`;
  const response = await fetch(url, {
    method: "PATCH",
    headers: {
      Accept: "application/json",
      "Content-Type": "application/json",
      Authorization: `Bearer ${bearer}`
    },
    body: JSON.stringify({
      technician_id: technicianId
    })
  });
  const raw = await response.json();
  if (!response.ok) {
    throw raw;
  }
  if (raw?.data) return raw.data;
  return raw;
};
const reassignTechnician = async (ticketId, technicianId) => {
  if (!ticketId) throw new Error("Ticket id is required");
  const token = useCookie("auth_token");
  let bearer = token.value || "";
  try {
    bearer = decodeURIComponent(bearer);
  } catch {
  }
  const url = `http://localhost:8000/api/tickets/${encodeURIComponent(ticketId)}/reassign`;
  const response = await fetch(url, {
    method: "PATCH",
    headers: {
      Accept: "application/json",
      "Content-Type": "application/json",
      Authorization: `Bearer ${bearer}`
    },
    body: JSON.stringify({
      assigned_tech_id: technicianId
    })
  });
  const raw = await response.json();
  if (!response.ok) {
    throw raw;
  }
  if (raw?.data) return raw.data;
  return raw;
};
const _sfc_main = /* @__PURE__ */ defineComponent({
  __name: "[id]",
  __ssrInlineRender: true,
  async setup(__props) {
    let __temp, __restore;
    const route = useRoute();
    const ticketId = computed(() => route.params.id);
    const isEditing = ref(false);
    const isSubmitting = ref(false);
    const form = reactive({
      status: "",
      priority: "",
      technicianId: ""
    });
    const statusOptions = ["open", "in_progress", "pending", "resolved", "closed"];
    const { data: ticket, status, refresh, error } = ([__temp, __restore] = withAsyncContext(() => useAsyncData(
      () => getTicketById(ticketId.value),
      {
        watch: [ticketId],
        server: false
      },
      "$QR50sK36FS"
    )), __temp = await __temp, __restore(), __temp);
    const { data: users, error: usersError, status: usersStatus, refresh: refreshUsers } = ([__temp, __restore] = withAsyncContext(() => useAsyncData("technicians", () => getTechnicians(), {
      server: false,
      lazy: true,
      default: () => []
    })), __temp = await __temp, __restore(), __temp);
    const technicianOptions = computed(() => {
      return (users.value || []).map((u) => ({ label: u.username || u.email || `Tech #${u.id}`, value: String(u.id) }));
    });
    const resolveFileUrl = (file) => {
      const raw = file?.url || file?.path || file?.file_path || file?.attachment_url || file?.location;
      if (!raw) return "";
      if (/^https?:\/\//i.test(raw)) return raw;
      const base = "http://localhost:8000/storage/";
      const cleaned = String(raw).replace(/^\/+/, "");
      if (cleaned.startsWith("storage/")) return `${base}/${cleaned}`;
      if (cleaned.startsWith("attachments/")) return `${base}/storage/${cleaned}`;
      if (cleaned.startsWith("storage\\")) return `${base}/${cleaned.replace("\\", "/")}`;
      return `${base}/${cleaned}`;
    };
    const displayAttachments = computed(() => {
      const files = ticket.value?.attachments || ticket.value?.files || ticket.value?.attachments?.data || ticket.value?.media || ticket.value?.documents || [];
      return (files || []).map((file) => ({
        url: resolveFileUrl(file),
        name: file?.name || file?.filename || file?.original_name || file?.file_name || file?.display_name || file?.path || file?.url || "File",
        type: file?.mime_type || file?.type || ""
      })).filter((f) => f.url);
    });
    const assignedTechnician = computed(() => {
      if (!ticket.value) return null;
      const techId = ticket.value.assigned_tech_id || ticket.value.technician_id;
      if (!techId) return null;
      return (users.value || []).find((u) => u.id == techId);
    });
    const acceptancePending = ref(false);
    const acceptanceTechName = ref(null);
    const acceptanceTechId = ref(null);
    const acceptanceLoading = ref(false);
    const technicianDisplayName = computed(() => {
      if (acceptancePending.value && acceptanceTechName.value) return acceptanceTechName.value;
      return assignedTechnician.value?.username || assignedTechnician.value?.email || ticket.value?.technician?.username || ticket.value?.technician?.name || ticket.value?.technician_name || "Unassigned";
    });
    const loadAcceptance = async () => {
      if (!ticketId.value) return;
      try {
        acceptanceLoading.value = true;
        const res = await isPending(ticketId.value);
        acceptancePending.value = !!res?.is_pending;
        acceptanceTechName.value = res?.technician_name ?? null;
        acceptanceTechId.value = res?.technician_id ?? null;
      } catch (err) {
        console.error("Failed to load acceptance pending state", err);
        acceptancePending.value = false;
        acceptanceTechName.value = null;
        acceptanceTechId.value = null;
      } finally {
        acceptanceLoading.value = false;
      }
    };
    const isAssigning = ref(false);
    const assignLoading = ref(false);
    const selectedAssignTech = ref("");
    const openAssign = async () => {
      isAssigning.value = true;
      if (!users.value || users.value.length === 0) {
        try {
          await refreshUsers();
        } catch (e) {
          console.error("Failed to load technicians", e);
        }
      }
      const techId = ticket.value?.assigned_tech_id || ticket.value?.technician_id || ticket.value?.technicianId || ticket.value?.technician?.id;
      selectedAssignTech.value = techId ? String(techId) : "";
    };
    const closeAssign = () => {
      isAssigning.value = false;
      selectedAssignTech.value = "";
    };
    const performAssign = async () => {
      if (!ticketId.value) return;
      if (!selectedAssignTech.value) return;
      assignLoading.value = true;
      try {
        const techId = Number(selectedAssignTech.value);
        console.log("About to send technician_id:", techId);
        if (ticket.value?.assigned_tech_id || ticket.value?.technician_id) {
          await reassignTechnician(ticketId.value, techId);
        } else {
          await assignTechnician(ticketId.value, techId);
        }
        await refresh();
        isAssigning.value = false;
      } catch (err) {
        console.error("Assign error", err);
      } finally {
        assignLoading.value = false;
      }
    };
    const elapsedTime = ref("");
    watchEffect(() => {
      if (ticket.value) {
        form.status = ticket.value.status || "";
        form.priority = ticket.value.priority || "";
        const techId = ticket.value.assigned_tech_id || ticket.value.technician_id || ticket.value.technicianId || ticket.value.technician?.id;
        form.technicianId = techId ? String(techId) : "";
      }
    });
    const toggleEdit = () => {
      isEditing.value = !isEditing.value;
      if (!isEditing.value && ticket.value) {
        form.status = ticket.value.status || "";
        form.priority = ticket.value.priority || "";
        const techId = ticket.value.assigned_tech_id || ticket.value.technician_id || ticket.value.technicianId || ticket.value.technician?.id;
        form.technicianId = techId ? String(techId) : "";
      }
    };
    const handleSave = async () => {
      if (isSubmitting.value || !ticketId.value) return;
      isSubmitting.value = true;
      try {
        const payload = {
          status: form.status || void 0,
          priority: form.priority || void 0,
          assigned_tech_id: form.technicianId ? Number(form.technicianId) : void 0
        };
        await updateTicketStatus(ticketId.value, form.status);
        await refresh();
        isEditing.value = false;
      } catch (err) {
        console.error("Failed to update ticket", err);
      } finally {
        isSubmitting.value = false;
      }
    };
    watch(ticket, (t) => {
      if (t) loadComments();
      if (t) loadAcceptance();
    });
    return (_ctx, _push, _parent, _attrs) => {
      const _component_UDashboardGroup = _sfc_main$e;
      const _component_Sidebar = __nuxt_component_1;
      const _component_UDashboardPage = resolveComponent("UDashboardPage");
      const _component_Navbar = __nuxt_component_2;
      const _component_UDashboardPageHeader = resolveComponent("UDashboardPageHeader");
      const _component_UButton = _sfc_main$1;
      const _component_UCard = _sfc_main$2;
      const _component_UBadge = _sfc_main$6;
      const _component_USelect = _sfc_main$3;
      const _component_UFormGroup = resolveComponent("UFormGroup");
      const _component_UAlert = _sfc_main$4;
      _push(ssrRenderComponent(_component_UDashboardGroup, _attrs, {
        default: withCtx((_, _push2, _parent2, _scopeId) => {
          if (_push2) {
            _push2(ssrRenderComponent(_component_Sidebar, null, null, _parent2, _scopeId));
            _push2(ssrRenderComponent(_component_UDashboardPage, { class: "flex flex-col h-screen min-w-0" }, {
              default: withCtx((_2, _push3, _parent3, _scopeId2) => {
                if (_push3) {
                  _push3(ssrRenderComponent(_component_Navbar, {
                    title: "Ticket",
                    icon: "i-lucide-ticket",
                    class: "w-full"
                  }, null, _parent3, _scopeId2));
                  _push3(`<div class="flex flex-col flex-1 min-h-0 gap-6 p-6"${_scopeId2}><div class="flex items-center justify-between gap-3"${_scopeId2}>`);
                  _push3(ssrRenderComponent(_component_UDashboardPageHeader, {
                    title: unref(ticket) ? `Ticket #${unref(ticket).id}` : "Ticket",
                    description: unref(ticket)?.title || "Ticket details"
                  }, null, _parent3, _scopeId2));
                  _push3(`<div class="flex gap-2"${_scopeId2}>`);
                  _push3(ssrRenderComponent(_component_UButton, {
                    size: "sm",
                    icon: unref(isEditing) ? "i-lucide-x" : "i-lucide-pencil",
                    color: unref(isEditing) ? "neutral" : "primary",
                    onClick: toggleEdit
                  }, {
                    default: withCtx((_3, _push4, _parent4, _scopeId3) => {
                      if (_push4) {
                        _push4(`${ssrInterpolate(unref(isEditing) ? "Cancel" : "Edit")}`);
                      } else {
                        return [
                          createTextVNode(toDisplayString(unref(isEditing) ? "Cancel" : "Edit"), 1)
                        ];
                      }
                    }),
                    _: 1
                  }, _parent3, _scopeId2));
                  _push3(ssrRenderComponent(_component_UButton, {
                    color: "neutral",
                    variant: "ghost",
                    icon: "i-lucide-arrow-left",
                    to: "/supervisor/tickets"
                  }, {
                    default: withCtx((_3, _push4, _parent4, _scopeId3) => {
                      if (_push4) {
                        _push4(` Back `);
                      } else {
                        return [
                          createTextVNode(" Back ")
                        ];
                      }
                    }),
                    _: 1
                  }, _parent3, _scopeId2));
                  _push3(`</div></div>`);
                  _push3(ssrRenderComponent(_component_UCard, {
                    ui: { body: "grid gap-4 sm:grid-cols-2" },
                    loading: unref(status) === "pending"
                  }, {
                    default: withCtx((_3, _push4, _parent4, _scopeId3) => {
                      if (_push4) {
                        if (!unref(isEditing)) {
                          _push4(`<!--[--><div class="space-y-1"${_scopeId3}><p class="text-xs text-muted-500"${_scopeId3}>Title</p><p class="text-base font-medium text-gray-900"${_scopeId3}>${ssrInterpolate(unref(ticket)?.title || "-")}</p></div><div class="space-y-1"${_scopeId3}><p class="text-xs text-muted-500"${_scopeId3}>Status</p>`);
                          _push4(ssrRenderComponent(_component_UBadge, {
                            color: "primary",
                            variant: "soft"
                          }, {
                            default: withCtx((_4, _push5, _parent5, _scopeId4) => {
                              if (_push5) {
                                _push5(`${ssrInterpolate(unref(ticket)?.status || "-")}`);
                              } else {
                                return [
                                  createTextVNode(toDisplayString(unref(ticket)?.status || "-"), 1)
                                ];
                              }
                            }),
                            _: 1
                          }, _parent4, _scopeId3));
                          _push4(`</div><div class="space-y-1"${_scopeId3}><p class="text-xs text-muted-500"${_scopeId3}>Time Elapsed</p><p class="text-base text-gray-900 font-mono"${_scopeId3}>${ssrInterpolate(unref(elapsedTime))}</p></div><div class="space-y-1"${_scopeId3}><p class="text-xs text-muted-500"${_scopeId3}>Priority</p><p class="text-base text-gray-900"${_scopeId3}>${ssrInterpolate(unref(ticket)?.priority || "-")}</p></div><div class="space-y-1"${_scopeId3}><p class="text-xs text-muted-500"${_scopeId3}>Technician</p><div class="flex items-center gap-3"${_scopeId3}><p class="${ssrRenderClass(["text-base", unref(acceptancePending) ? "text-orange-600" : "text-gray-900"])}"${_scopeId3}>${ssrInterpolate(unref(technicianDisplayName))}</p>`);
                          if (unref(acceptancePending)) {
                            _push4(`<span class="text-xs text-orange-700 ml-2"${_scopeId3}>(pending acceptance)</span>`);
                          } else {
                            _push4(`<!---->`);
                          }
                          _push4(ssrRenderComponent(_component_UButton, {
                            size: "sm",
                            variant: "ghost",
                            color: "primary",
                            onClick: openAssign
                          }, {
                            default: withCtx((_4, _push5, _parent5, _scopeId4) => {
                              if (_push5) {
                                _push5(`${ssrInterpolate(unref(assignedTechnician) || unref(ticket)?.assigned_tech_id || unref(ticket)?.technician_id ? "Reassign" : "Assign")}`);
                              } else {
                                return [
                                  createTextVNode(toDisplayString(unref(assignedTechnician) || unref(ticket)?.assigned_tech_id || unref(ticket)?.technician_id ? "Reassign" : "Assign"), 1)
                                ];
                              }
                            }),
                            _: 1
                          }, _parent4, _scopeId3));
                          _push4(`</div>`);
                          if (unref(isAssigning)) {
                            _push4(`<div class="mt-3 flex items-center gap-3"${_scopeId3}>`);
                            _push4(ssrRenderComponent(_component_USelect, {
                              modelValue: unref(selectedAssignTech),
                              "onUpdate:modelValue": ($event) => isRef(selectedAssignTech) ? selectedAssignTech.value = $event : null,
                              items: unref(technicianOptions),
                              placeholder: "Choose technician"
                            }, null, _parent4, _scopeId3));
                            _push4(ssrRenderComponent(_component_UButton, {
                              size: "sm",
                              color: "primary",
                              loading: unref(assignLoading),
                              onClick: performAssign
                            }, {
                              default: withCtx((_4, _push5, _parent5, _scopeId4) => {
                                if (_push5) {
                                  _push5(`Confirm`);
                                } else {
                                  return [
                                    createTextVNode("Confirm")
                                  ];
                                }
                              }),
                              _: 1
                            }, _parent4, _scopeId3));
                            _push4(ssrRenderComponent(_component_UButton, {
                              size: "sm",
                              color: "neutral",
                              variant: "ghost",
                              onClick: closeAssign
                            }, {
                              default: withCtx((_4, _push5, _parent5, _scopeId4) => {
                                if (_push5) {
                                  _push5(`Cancel`);
                                } else {
                                  return [
                                    createTextVNode("Cancel")
                                  ];
                                }
                              }),
                              _: 1
                            }, _parent4, _scopeId3));
                            _push4(`</div>`);
                          } else {
                            _push4(`<!---->`);
                          }
                          _push4(`</div><div class="space-y-1"${_scopeId3}><p class="text-xs text-muted-500"${_scopeId3}>Category</p><p class="text-base text-gray-900"${_scopeId3}>${ssrInterpolate(unref(ticket)?.category?.name || "-")}</p></div><div class="space-y-1 sm:col-span-2"${_scopeId3}><p class="text-xs text-muted-500"${_scopeId3}>Description</p><p class="text-base text-gray-900 whitespace-pre-line"${_scopeId3}>${ssrInterpolate(unref(ticket)?.description || "-")}</p></div>`);
                          if (unref(displayAttachments).length) {
                            _push4(`<div class="space-y-1 sm:col-span-2"${_scopeId3}><p class="text-xs text-muted-500"${_scopeId3}>Attachments</p><div class="flex flex-wrap gap-4"${_scopeId3}><!--[-->`);
                            ssrRenderList(unref(displayAttachments), (file) => {
                              _push4(`<div class="flex flex-col items-center w-32"${_scopeId3}>`);
                              if (file.url && (file.url.endsWith(".png") || file.url.endsWith(".jpg") || file.url.endsWith(".jpeg") || file.url.endsWith(".gif"))) {
                                _push4(`<img${ssrRenderAttr("src", file.url)}${ssrRenderAttr("alt", file.name)} class="w-28 h-28 object-cover rounded border"${_scopeId3}>`);
                              } else if (file.url && file.url.endsWith(".pdf")) {
                                _push4(`<embed${ssrRenderAttr("src", file.url)} type="application/pdf" class="w-28 h-28 border rounded"${_scopeId3}>`);
                              } else {
                                _push4(`<span class="i-lucide-file text-3xl text-gray-400 mb-2"${_scopeId3}></span>`);
                              }
                              _push4(`<a${ssrRenderAttr("href", file.url)} target="_blank" class="text-xs text-primary underline mt-1 break-all"${_scopeId3}>${ssrInterpolate(file.name || file.url)}</a></div>`);
                            });
                            _push4(`<!--]--></div></div>`);
                          } else {
                            _push4(`<!---->`);
                          }
                          _push4(`<!--]-->`);
                        } else {
                          _push4(`<!--[--><div class="space-y-1"${_scopeId3}><p class="text-xs text-muted-500"${_scopeId3}>Title</p><p class="text-base font-medium text-gray-900"${_scopeId3}>${ssrInterpolate(unref(ticket)?.title || "-")}</p></div>`);
                          _push4(ssrRenderComponent(_component_UFormGroup, {
                            label: "Status",
                            name: "status"
                          }, {
                            default: withCtx((_4, _push5, _parent5, _scopeId4) => {
                              if (_push5) {
                                _push5(ssrRenderComponent(_component_USelect, {
                                  modelValue: unref(form).status,
                                  "onUpdate:modelValue": ($event) => unref(form).status = $event,
                                  items: statusOptions,
                                  placeholder: "Select status"
                                }, null, _parent5, _scopeId4));
                              } else {
                                return [
                                  createVNode(_component_USelect, {
                                    modelValue: unref(form).status,
                                    "onUpdate:modelValue": ($event) => unref(form).status = $event,
                                    items: statusOptions,
                                    placeholder: "Select status"
                                  }, null, 8, ["modelValue", "onUpdate:modelValue"])
                                ];
                              }
                            }),
                            _: 1
                          }, _parent4, _scopeId3));
                          _push4(ssrRenderComponent(_component_UFormGroup, {
                            label: "Priority",
                            name: "priority"
                          }, {
                            default: withCtx((_4, _push5, _parent5, _scopeId4) => {
                              if (_push5) {
                                _push5(`<p class="text-base text-gray-900"${_scopeId4}>${ssrInterpolate(unref(ticket)?.priority || "-")}</p>`);
                              } else {
                                return [
                                  createVNode("p", { class: "text-base text-gray-900" }, toDisplayString(unref(ticket)?.priority || "-"), 1)
                                ];
                              }
                            }),
                            _: 1
                          }, _parent4, _scopeId3));
                          _push4(ssrRenderComponent(_component_UFormGroup, {
                            label: "Assign technician",
                            name: "technician"
                          }, {
                            default: withCtx((_4, _push5, _parent5, _scopeId4) => {
                              if (_push5) {
                                _push5(`<p class="text-base text-gray-900"${_scopeId4}>${ssrInterpolate(unref(assignedTechnician)?.username || unref(assignedTechnician)?.email || unref(ticket)?.technician?.username || unref(ticket)?.technician?.name || unref(ticket)?.technician_name || "Unassigned")}</p>`);
                              } else {
                                return [
                                  createVNode("p", { class: "text-base text-gray-900" }, toDisplayString(unref(assignedTechnician)?.username || unref(assignedTechnician)?.email || unref(ticket)?.technician?.username || unref(ticket)?.technician?.name || unref(ticket)?.technician_name || "Unassigned"), 1)
                                ];
                              }
                            }),
                            _: 1
                          }, _parent4, _scopeId3));
                          _push4(`<div class="space-y-1"${_scopeId3}><p class="text-xs text-muted-500"${_scopeId3}>Category</p><p class="text-base text-gray-900"${_scopeId3}>${ssrInterpolate(unref(ticket)?.category?.name || "-")}</p></div><div class="space-y-1 sm:col-span-2"${_scopeId3}><p class="text-xs text-muted-500"${_scopeId3}>Description</p><p class="text-base text-gray-900 whitespace-pre-line"${_scopeId3}>${ssrInterpolate(unref(ticket)?.description || "-")}</p></div><div class="sm:col-span-2 flex justify-end gap-3 pt-2"${_scopeId3}>`);
                          _push4(ssrRenderComponent(_component_UButton, {
                            type: "button",
                            color: "neutral",
                            variant: "ghost",
                            onClick: toggleEdit
                          }, {
                            default: withCtx((_4, _push5, _parent5, _scopeId4) => {
                              if (_push5) {
                                _push5(`Cancel`);
                              } else {
                                return [
                                  createTextVNode("Cancel")
                                ];
                              }
                            }),
                            _: 1
                          }, _parent4, _scopeId3));
                          _push4(ssrRenderComponent(_component_UButton, {
                            type: "button",
                            color: "primary",
                            icon: "i-lucide-check",
                            loading: unref(isSubmitting),
                            disabled: unref(isSubmitting),
                            onClick: handleSave
                          }, {
                            default: withCtx((_4, _push5, _parent5, _scopeId4) => {
                              if (_push5) {
                                _push5(` Save Changes `);
                              } else {
                                return [
                                  createTextVNode(" Save Changes ")
                                ];
                              }
                            }),
                            _: 1
                          }, _parent4, _scopeId3));
                          _push4(`</div><!--]-->`);
                        }
                      } else {
                        return [
                          !unref(isEditing) ? (openBlock(), createBlock(Fragment, { key: 0 }, [
                            createVNode("div", { class: "space-y-1" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Title"),
                              createVNode("p", { class: "text-base font-medium text-gray-900" }, toDisplayString(unref(ticket)?.title || "-"), 1)
                            ]),
                            createVNode("div", { class: "space-y-1" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Status"),
                              createVNode(_component_UBadge, {
                                color: "primary",
                                variant: "soft"
                              }, {
                                default: withCtx(() => [
                                  createTextVNode(toDisplayString(unref(ticket)?.status || "-"), 1)
                                ]),
                                _: 1
                              })
                            ]),
                            createVNode("div", { class: "space-y-1" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Time Elapsed"),
                              createVNode("p", { class: "text-base text-gray-900 font-mono" }, toDisplayString(unref(elapsedTime)), 1)
                            ]),
                            createVNode("div", { class: "space-y-1" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Priority"),
                              createVNode("p", { class: "text-base text-gray-900" }, toDisplayString(unref(ticket)?.priority || "-"), 1)
                            ]),
                            createVNode("div", { class: "space-y-1" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Technician"),
                              createVNode("div", { class: "flex items-center gap-3" }, [
                                createVNode("p", {
                                  class: ["text-base", unref(acceptancePending) ? "text-orange-600" : "text-gray-900"]
                                }, toDisplayString(unref(technicianDisplayName)), 3),
                                unref(acceptancePending) ? (openBlock(), createBlock("span", {
                                  key: 0,
                                  class: "text-xs text-orange-700 ml-2"
                                }, "(pending acceptance)")) : createCommentVNode("", true),
                                createVNode(_component_UButton, {
                                  size: "sm",
                                  variant: "ghost",
                                  color: "primary",
                                  onClick: openAssign
                                }, {
                                  default: withCtx(() => [
                                    createTextVNode(toDisplayString(unref(assignedTechnician) || unref(ticket)?.assigned_tech_id || unref(ticket)?.technician_id ? "Reassign" : "Assign"), 1)
                                  ]),
                                  _: 1
                                })
                              ]),
                              unref(isAssigning) ? (openBlock(), createBlock("div", {
                                key: 0,
                                class: "mt-3 flex items-center gap-3"
                              }, [
                                createVNode(_component_USelect, {
                                  modelValue: unref(selectedAssignTech),
                                  "onUpdate:modelValue": ($event) => isRef(selectedAssignTech) ? selectedAssignTech.value = $event : null,
                                  items: unref(technicianOptions),
                                  placeholder: "Choose technician"
                                }, null, 8, ["modelValue", "onUpdate:modelValue", "items"]),
                                createVNode(_component_UButton, {
                                  size: "sm",
                                  color: "primary",
                                  loading: unref(assignLoading),
                                  onClick: performAssign
                                }, {
                                  default: withCtx(() => [
                                    createTextVNode("Confirm")
                                  ]),
                                  _: 1
                                }, 8, ["loading"]),
                                createVNode(_component_UButton, {
                                  size: "sm",
                                  color: "neutral",
                                  variant: "ghost",
                                  onClick: closeAssign
                                }, {
                                  default: withCtx(() => [
                                    createTextVNode("Cancel")
                                  ]),
                                  _: 1
                                })
                              ])) : createCommentVNode("", true)
                            ]),
                            createVNode("div", { class: "space-y-1" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Category"),
                              createVNode("p", { class: "text-base text-gray-900" }, toDisplayString(unref(ticket)?.category?.name || "-"), 1)
                            ]),
                            createVNode("div", { class: "space-y-1 sm:col-span-2" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Description"),
                              createVNode("p", { class: "text-base text-gray-900 whitespace-pre-line" }, toDisplayString(unref(ticket)?.description || "-"), 1)
                            ]),
                            unref(displayAttachments).length ? (openBlock(), createBlock("div", {
                              key: 0,
                              class: "space-y-1 sm:col-span-2"
                            }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Attachments"),
                              createVNode("div", { class: "flex flex-wrap gap-4" }, [
                                (openBlock(true), createBlock(Fragment, null, renderList(unref(displayAttachments), (file) => {
                                  return openBlock(), createBlock("div", {
                                    key: file.url || file.name,
                                    class: "flex flex-col items-center w-32"
                                  }, [
                                    file.url && (file.url.endsWith(".png") || file.url.endsWith(".jpg") || file.url.endsWith(".jpeg") || file.url.endsWith(".gif")) ? (openBlock(), createBlock("img", {
                                      key: 0,
                                      src: file.url,
                                      alt: file.name,
                                      class: "w-28 h-28 object-cover rounded border"
                                    }, null, 8, ["src", "alt"])) : file.url && file.url.endsWith(".pdf") ? (openBlock(), createBlock("embed", {
                                      key: 1,
                                      src: file.url,
                                      type: "application/pdf",
                                      class: "w-28 h-28 border rounded"
                                    }, null, 8, ["src"])) : (openBlock(), createBlock("span", {
                                      key: 2,
                                      class: "i-lucide-file text-3xl text-gray-400 mb-2"
                                    })),
                                    createVNode("a", {
                                      href: file.url,
                                      target: "_blank",
                                      class: "text-xs text-primary underline mt-1 break-all"
                                    }, toDisplayString(file.name || file.url), 9, ["href"])
                                  ]);
                                }), 128))
                              ])
                            ])) : createCommentVNode("", true)
                          ], 64)) : (openBlock(), createBlock(Fragment, { key: 1 }, [
                            createVNode("div", { class: "space-y-1" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Title"),
                              createVNode("p", { class: "text-base font-medium text-gray-900" }, toDisplayString(unref(ticket)?.title || "-"), 1)
                            ]),
                            createVNode(_component_UFormGroup, {
                              label: "Status",
                              name: "status"
                            }, {
                              default: withCtx(() => [
                                createVNode(_component_USelect, {
                                  modelValue: unref(form).status,
                                  "onUpdate:modelValue": ($event) => unref(form).status = $event,
                                  items: statusOptions,
                                  placeholder: "Select status"
                                }, null, 8, ["modelValue", "onUpdate:modelValue"])
                              ]),
                              _: 1
                            }),
                            createVNode(_component_UFormGroup, {
                              label: "Priority",
                              name: "priority"
                            }, {
                              default: withCtx(() => [
                                createVNode("p", { class: "text-base text-gray-900" }, toDisplayString(unref(ticket)?.priority || "-"), 1)
                              ]),
                              _: 1
                            }),
                            createVNode(_component_UFormGroup, {
                              label: "Assign technician",
                              name: "technician"
                            }, {
                              default: withCtx(() => [
                                createVNode("p", { class: "text-base text-gray-900" }, toDisplayString(unref(assignedTechnician)?.username || unref(assignedTechnician)?.email || unref(ticket)?.technician?.username || unref(ticket)?.technician?.name || unref(ticket)?.technician_name || "Unassigned"), 1)
                              ]),
                              _: 1
                            }),
                            createVNode("div", { class: "space-y-1" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Category"),
                              createVNode("p", { class: "text-base text-gray-900" }, toDisplayString(unref(ticket)?.category?.name || "-"), 1)
                            ]),
                            createVNode("div", { class: "space-y-1 sm:col-span-2" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Description"),
                              createVNode("p", { class: "text-base text-gray-900 whitespace-pre-line" }, toDisplayString(unref(ticket)?.description || "-"), 1)
                            ]),
                            createVNode("div", { class: "sm:col-span-2 flex justify-end gap-3 pt-2" }, [
                              createVNode(_component_UButton, {
                                type: "button",
                                color: "neutral",
                                variant: "ghost",
                                onClick: toggleEdit
                              }, {
                                default: withCtx(() => [
                                  createTextVNode("Cancel")
                                ]),
                                _: 1
                              }),
                              createVNode(_component_UButton, {
                                type: "button",
                                color: "primary",
                                icon: "i-lucide-check",
                                loading: unref(isSubmitting),
                                disabled: unref(isSubmitting),
                                onClick: handleSave
                              }, {
                                default: withCtx(() => [
                                  createTextVNode(" Save Changes ")
                                ]),
                                _: 1
                              }, 8, ["loading", "disabled"])
                            ])
                          ], 64))
                        ];
                      }
                    }),
                    _: 1
                  }, _parent3, _scopeId2));
                  _push3(ssrRenderComponent(__nuxt_component_7, { "ticket-id": unref(ticketId) }, null, _parent3, _scopeId2));
                  if (unref(error)) {
                    _push3(ssrRenderComponent(_component_UAlert, {
                      icon: "i-lucide-alert-triangle",
                      color: "red",
                      variant: "soft",
                      title: "Unable to load ticket",
                      description: unref(error)?.message || "Please try again."
                    }, null, _parent3, _scopeId2));
                  } else {
                    _push3(`<!---->`);
                  }
                  _push3(`</div>`);
                } else {
                  return [
                    createVNode(_component_Navbar, {
                      title: "Ticket",
                      icon: "i-lucide-ticket",
                      class: "w-full"
                    }),
                    createVNode("div", { class: "flex flex-col flex-1 min-h-0 gap-6 p-6" }, [
                      createVNode("div", { class: "flex items-center justify-between gap-3" }, [
                        createVNode(_component_UDashboardPageHeader, {
                          title: unref(ticket) ? `Ticket #${unref(ticket).id}` : "Ticket",
                          description: unref(ticket)?.title || "Ticket details"
                        }, null, 8, ["title", "description"]),
                        createVNode("div", { class: "flex gap-2" }, [
                          createVNode(_component_UButton, {
                            size: "sm",
                            icon: unref(isEditing) ? "i-lucide-x" : "i-lucide-pencil",
                            color: unref(isEditing) ? "neutral" : "primary",
                            onClick: toggleEdit
                          }, {
                            default: withCtx(() => [
                              createTextVNode(toDisplayString(unref(isEditing) ? "Cancel" : "Edit"), 1)
                            ]),
                            _: 1
                          }, 8, ["icon", "color"]),
                          createVNode(_component_UButton, {
                            color: "neutral",
                            variant: "ghost",
                            icon: "i-lucide-arrow-left",
                            to: "/supervisor/tickets"
                          }, {
                            default: withCtx(() => [
                              createTextVNode(" Back ")
                            ]),
                            _: 1
                          })
                        ])
                      ]),
                      createVNode(_component_UCard, {
                        ui: { body: "grid gap-4 sm:grid-cols-2" },
                        loading: unref(status) === "pending"
                      }, {
                        default: withCtx(() => [
                          !unref(isEditing) ? (openBlock(), createBlock(Fragment, { key: 0 }, [
                            createVNode("div", { class: "space-y-1" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Title"),
                              createVNode("p", { class: "text-base font-medium text-gray-900" }, toDisplayString(unref(ticket)?.title || "-"), 1)
                            ]),
                            createVNode("div", { class: "space-y-1" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Status"),
                              createVNode(_component_UBadge, {
                                color: "primary",
                                variant: "soft"
                              }, {
                                default: withCtx(() => [
                                  createTextVNode(toDisplayString(unref(ticket)?.status || "-"), 1)
                                ]),
                                _: 1
                              })
                            ]),
                            createVNode("div", { class: "space-y-1" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Time Elapsed"),
                              createVNode("p", { class: "text-base text-gray-900 font-mono" }, toDisplayString(unref(elapsedTime)), 1)
                            ]),
                            createVNode("div", { class: "space-y-1" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Priority"),
                              createVNode("p", { class: "text-base text-gray-900" }, toDisplayString(unref(ticket)?.priority || "-"), 1)
                            ]),
                            createVNode("div", { class: "space-y-1" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Technician"),
                              createVNode("div", { class: "flex items-center gap-3" }, [
                                createVNode("p", {
                                  class: ["text-base", unref(acceptancePending) ? "text-orange-600" : "text-gray-900"]
                                }, toDisplayString(unref(technicianDisplayName)), 3),
                                unref(acceptancePending) ? (openBlock(), createBlock("span", {
                                  key: 0,
                                  class: "text-xs text-orange-700 ml-2"
                                }, "(pending acceptance)")) : createCommentVNode("", true),
                                createVNode(_component_UButton, {
                                  size: "sm",
                                  variant: "ghost",
                                  color: "primary",
                                  onClick: openAssign
                                }, {
                                  default: withCtx(() => [
                                    createTextVNode(toDisplayString(unref(assignedTechnician) || unref(ticket)?.assigned_tech_id || unref(ticket)?.technician_id ? "Reassign" : "Assign"), 1)
                                  ]),
                                  _: 1
                                })
                              ]),
                              unref(isAssigning) ? (openBlock(), createBlock("div", {
                                key: 0,
                                class: "mt-3 flex items-center gap-3"
                              }, [
                                createVNode(_component_USelect, {
                                  modelValue: unref(selectedAssignTech),
                                  "onUpdate:modelValue": ($event) => isRef(selectedAssignTech) ? selectedAssignTech.value = $event : null,
                                  items: unref(technicianOptions),
                                  placeholder: "Choose technician"
                                }, null, 8, ["modelValue", "onUpdate:modelValue", "items"]),
                                createVNode(_component_UButton, {
                                  size: "sm",
                                  color: "primary",
                                  loading: unref(assignLoading),
                                  onClick: performAssign
                                }, {
                                  default: withCtx(() => [
                                    createTextVNode("Confirm")
                                  ]),
                                  _: 1
                                }, 8, ["loading"]),
                                createVNode(_component_UButton, {
                                  size: "sm",
                                  color: "neutral",
                                  variant: "ghost",
                                  onClick: closeAssign
                                }, {
                                  default: withCtx(() => [
                                    createTextVNode("Cancel")
                                  ]),
                                  _: 1
                                })
                              ])) : createCommentVNode("", true)
                            ]),
                            createVNode("div", { class: "space-y-1" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Category"),
                              createVNode("p", { class: "text-base text-gray-900" }, toDisplayString(unref(ticket)?.category?.name || "-"), 1)
                            ]),
                            createVNode("div", { class: "space-y-1 sm:col-span-2" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Description"),
                              createVNode("p", { class: "text-base text-gray-900 whitespace-pre-line" }, toDisplayString(unref(ticket)?.description || "-"), 1)
                            ]),
                            unref(displayAttachments).length ? (openBlock(), createBlock("div", {
                              key: 0,
                              class: "space-y-1 sm:col-span-2"
                            }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Attachments"),
                              createVNode("div", { class: "flex flex-wrap gap-4" }, [
                                (openBlock(true), createBlock(Fragment, null, renderList(unref(displayAttachments), (file) => {
                                  return openBlock(), createBlock("div", {
                                    key: file.url || file.name,
                                    class: "flex flex-col items-center w-32"
                                  }, [
                                    file.url && (file.url.endsWith(".png") || file.url.endsWith(".jpg") || file.url.endsWith(".jpeg") || file.url.endsWith(".gif")) ? (openBlock(), createBlock("img", {
                                      key: 0,
                                      src: file.url,
                                      alt: file.name,
                                      class: "w-28 h-28 object-cover rounded border"
                                    }, null, 8, ["src", "alt"])) : file.url && file.url.endsWith(".pdf") ? (openBlock(), createBlock("embed", {
                                      key: 1,
                                      src: file.url,
                                      type: "application/pdf",
                                      class: "w-28 h-28 border rounded"
                                    }, null, 8, ["src"])) : (openBlock(), createBlock("span", {
                                      key: 2,
                                      class: "i-lucide-file text-3xl text-gray-400 mb-2"
                                    })),
                                    createVNode("a", {
                                      href: file.url,
                                      target: "_blank",
                                      class: "text-xs text-primary underline mt-1 break-all"
                                    }, toDisplayString(file.name || file.url), 9, ["href"])
                                  ]);
                                }), 128))
                              ])
                            ])) : createCommentVNode("", true)
                          ], 64)) : (openBlock(), createBlock(Fragment, { key: 1 }, [
                            createVNode("div", { class: "space-y-1" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Title"),
                              createVNode("p", { class: "text-base font-medium text-gray-900" }, toDisplayString(unref(ticket)?.title || "-"), 1)
                            ]),
                            createVNode(_component_UFormGroup, {
                              label: "Status",
                              name: "status"
                            }, {
                              default: withCtx(() => [
                                createVNode(_component_USelect, {
                                  modelValue: unref(form).status,
                                  "onUpdate:modelValue": ($event) => unref(form).status = $event,
                                  items: statusOptions,
                                  placeholder: "Select status"
                                }, null, 8, ["modelValue", "onUpdate:modelValue"])
                              ]),
                              _: 1
                            }),
                            createVNode(_component_UFormGroup, {
                              label: "Priority",
                              name: "priority"
                            }, {
                              default: withCtx(() => [
                                createVNode("p", { class: "text-base text-gray-900" }, toDisplayString(unref(ticket)?.priority || "-"), 1)
                              ]),
                              _: 1
                            }),
                            createVNode(_component_UFormGroup, {
                              label: "Assign technician",
                              name: "technician"
                            }, {
                              default: withCtx(() => [
                                createVNode("p", { class: "text-base text-gray-900" }, toDisplayString(unref(assignedTechnician)?.username || unref(assignedTechnician)?.email || unref(ticket)?.technician?.username || unref(ticket)?.technician?.name || unref(ticket)?.technician_name || "Unassigned"), 1)
                              ]),
                              _: 1
                            }),
                            createVNode("div", { class: "space-y-1" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Category"),
                              createVNode("p", { class: "text-base text-gray-900" }, toDisplayString(unref(ticket)?.category?.name || "-"), 1)
                            ]),
                            createVNode("div", { class: "space-y-1 sm:col-span-2" }, [
                              createVNode("p", { class: "text-xs text-muted-500" }, "Description"),
                              createVNode("p", { class: "text-base text-gray-900 whitespace-pre-line" }, toDisplayString(unref(ticket)?.description || "-"), 1)
                            ]),
                            createVNode("div", { class: "sm:col-span-2 flex justify-end gap-3 pt-2" }, [
                              createVNode(_component_UButton, {
                                type: "button",
                                color: "neutral",
                                variant: "ghost",
                                onClick: toggleEdit
                              }, {
                                default: withCtx(() => [
                                  createTextVNode("Cancel")
                                ]),
                                _: 1
                              }),
                              createVNode(_component_UButton, {
                                type: "button",
                                color: "primary",
                                icon: "i-lucide-check",
                                loading: unref(isSubmitting),
                                disabled: unref(isSubmitting),
                                onClick: handleSave
                              }, {
                                default: withCtx(() => [
                                  createTextVNode(" Save Changes ")
                                ]),
                                _: 1
                              }, 8, ["loading", "disabled"])
                            ])
                          ], 64))
                        ]),
                        _: 1
                      }, 8, ["loading"]),
                      createVNode(__nuxt_component_7, { "ticket-id": unref(ticketId) }, null, 8, ["ticket-id"]),
                      unref(error) ? (openBlock(), createBlock(_component_UAlert, {
                        key: 0,
                        icon: "i-lucide-alert-triangle",
                        color: "red",
                        variant: "soft",
                        title: "Unable to load ticket",
                        description: unref(error)?.message || "Please try again."
                      }, null, 8, ["description"])) : createCommentVNode("", true)
                    ])
                  ];
                }
              }),
              _: 1
            }, _parent2, _scopeId));
          } else {
            return [
              createVNode(_component_Sidebar),
              createVNode(_component_UDashboardPage, { class: "flex flex-col h-screen min-w-0" }, {
                default: withCtx(() => [
                  createVNode(_component_Navbar, {
                    title: "Ticket",
                    icon: "i-lucide-ticket",
                    class: "w-full"
                  }),
                  createVNode("div", { class: "flex flex-col flex-1 min-h-0 gap-6 p-6" }, [
                    createVNode("div", { class: "flex items-center justify-between gap-3" }, [
                      createVNode(_component_UDashboardPageHeader, {
                        title: unref(ticket) ? `Ticket #${unref(ticket).id}` : "Ticket",
                        description: unref(ticket)?.title || "Ticket details"
                      }, null, 8, ["title", "description"]),
                      createVNode("div", { class: "flex gap-2" }, [
                        createVNode(_component_UButton, {
                          size: "sm",
                          icon: unref(isEditing) ? "i-lucide-x" : "i-lucide-pencil",
                          color: unref(isEditing) ? "neutral" : "primary",
                          onClick: toggleEdit
                        }, {
                          default: withCtx(() => [
                            createTextVNode(toDisplayString(unref(isEditing) ? "Cancel" : "Edit"), 1)
                          ]),
                          _: 1
                        }, 8, ["icon", "color"]),
                        createVNode(_component_UButton, {
                          color: "neutral",
                          variant: "ghost",
                          icon: "i-lucide-arrow-left",
                          to: "/supervisor/tickets"
                        }, {
                          default: withCtx(() => [
                            createTextVNode(" Back ")
                          ]),
                          _: 1
                        })
                      ])
                    ]),
                    createVNode(_component_UCard, {
                      ui: { body: "grid gap-4 sm:grid-cols-2" },
                      loading: unref(status) === "pending"
                    }, {
                      default: withCtx(() => [
                        !unref(isEditing) ? (openBlock(), createBlock(Fragment, { key: 0 }, [
                          createVNode("div", { class: "space-y-1" }, [
                            createVNode("p", { class: "text-xs text-muted-500" }, "Title"),
                            createVNode("p", { class: "text-base font-medium text-gray-900" }, toDisplayString(unref(ticket)?.title || "-"), 1)
                          ]),
                          createVNode("div", { class: "space-y-1" }, [
                            createVNode("p", { class: "text-xs text-muted-500" }, "Status"),
                            createVNode(_component_UBadge, {
                              color: "primary",
                              variant: "soft"
                            }, {
                              default: withCtx(() => [
                                createTextVNode(toDisplayString(unref(ticket)?.status || "-"), 1)
                              ]),
                              _: 1
                            })
                          ]),
                          createVNode("div", { class: "space-y-1" }, [
                            createVNode("p", { class: "text-xs text-muted-500" }, "Time Elapsed"),
                            createVNode("p", { class: "text-base text-gray-900 font-mono" }, toDisplayString(unref(elapsedTime)), 1)
                          ]),
                          createVNode("div", { class: "space-y-1" }, [
                            createVNode("p", { class: "text-xs text-muted-500" }, "Priority"),
                            createVNode("p", { class: "text-base text-gray-900" }, toDisplayString(unref(ticket)?.priority || "-"), 1)
                          ]),
                          createVNode("div", { class: "space-y-1" }, [
                            createVNode("p", { class: "text-xs text-muted-500" }, "Technician"),
                            createVNode("div", { class: "flex items-center gap-3" }, [
                              createVNode("p", {
                                class: ["text-base", unref(acceptancePending) ? "text-orange-600" : "text-gray-900"]
                              }, toDisplayString(unref(technicianDisplayName)), 3),
                              unref(acceptancePending) ? (openBlock(), createBlock("span", {
                                key: 0,
                                class: "text-xs text-orange-700 ml-2"
                              }, "(pending acceptance)")) : createCommentVNode("", true),
                              createVNode(_component_UButton, {
                                size: "sm",
                                variant: "ghost",
                                color: "primary",
                                onClick: openAssign
                              }, {
                                default: withCtx(() => [
                                  createTextVNode(toDisplayString(unref(assignedTechnician) || unref(ticket)?.assigned_tech_id || unref(ticket)?.technician_id ? "Reassign" : "Assign"), 1)
                                ]),
                                _: 1
                              })
                            ]),
                            unref(isAssigning) ? (openBlock(), createBlock("div", {
                              key: 0,
                              class: "mt-3 flex items-center gap-3"
                            }, [
                              createVNode(_component_USelect, {
                                modelValue: unref(selectedAssignTech),
                                "onUpdate:modelValue": ($event) => isRef(selectedAssignTech) ? selectedAssignTech.value = $event : null,
                                items: unref(technicianOptions),
                                placeholder: "Choose technician"
                              }, null, 8, ["modelValue", "onUpdate:modelValue", "items"]),
                              createVNode(_component_UButton, {
                                size: "sm",
                                color: "primary",
                                loading: unref(assignLoading),
                                onClick: performAssign
                              }, {
                                default: withCtx(() => [
                                  createTextVNode("Confirm")
                                ]),
                                _: 1
                              }, 8, ["loading"]),
                              createVNode(_component_UButton, {
                                size: "sm",
                                color: "neutral",
                                variant: "ghost",
                                onClick: closeAssign
                              }, {
                                default: withCtx(() => [
                                  createTextVNode("Cancel")
                                ]),
                                _: 1
                              })
                            ])) : createCommentVNode("", true)
                          ]),
                          createVNode("div", { class: "space-y-1" }, [
                            createVNode("p", { class: "text-xs text-muted-500" }, "Category"),
                            createVNode("p", { class: "text-base text-gray-900" }, toDisplayString(unref(ticket)?.category?.name || "-"), 1)
                          ]),
                          createVNode("div", { class: "space-y-1 sm:col-span-2" }, [
                            createVNode("p", { class: "text-xs text-muted-500" }, "Description"),
                            createVNode("p", { class: "text-base text-gray-900 whitespace-pre-line" }, toDisplayString(unref(ticket)?.description || "-"), 1)
                          ]),
                          unref(displayAttachments).length ? (openBlock(), createBlock("div", {
                            key: 0,
                            class: "space-y-1 sm:col-span-2"
                          }, [
                            createVNode("p", { class: "text-xs text-muted-500" }, "Attachments"),
                            createVNode("div", { class: "flex flex-wrap gap-4" }, [
                              (openBlock(true), createBlock(Fragment, null, renderList(unref(displayAttachments), (file) => {
                                return openBlock(), createBlock("div", {
                                  key: file.url || file.name,
                                  class: "flex flex-col items-center w-32"
                                }, [
                                  file.url && (file.url.endsWith(".png") || file.url.endsWith(".jpg") || file.url.endsWith(".jpeg") || file.url.endsWith(".gif")) ? (openBlock(), createBlock("img", {
                                    key: 0,
                                    src: file.url,
                                    alt: file.name,
                                    class: "w-28 h-28 object-cover rounded border"
                                  }, null, 8, ["src", "alt"])) : file.url && file.url.endsWith(".pdf") ? (openBlock(), createBlock("embed", {
                                    key: 1,
                                    src: file.url,
                                    type: "application/pdf",
                                    class: "w-28 h-28 border rounded"
                                  }, null, 8, ["src"])) : (openBlock(), createBlock("span", {
                                    key: 2,
                                    class: "i-lucide-file text-3xl text-gray-400 mb-2"
                                  })),
                                  createVNode("a", {
                                    href: file.url,
                                    target: "_blank",
                                    class: "text-xs text-primary underline mt-1 break-all"
                                  }, toDisplayString(file.name || file.url), 9, ["href"])
                                ]);
                              }), 128))
                            ])
                          ])) : createCommentVNode("", true)
                        ], 64)) : (openBlock(), createBlock(Fragment, { key: 1 }, [
                          createVNode("div", { class: "space-y-1" }, [
                            createVNode("p", { class: "text-xs text-muted-500" }, "Title"),
                            createVNode("p", { class: "text-base font-medium text-gray-900" }, toDisplayString(unref(ticket)?.title || "-"), 1)
                          ]),
                          createVNode(_component_UFormGroup, {
                            label: "Status",
                            name: "status"
                          }, {
                            default: withCtx(() => [
                              createVNode(_component_USelect, {
                                modelValue: unref(form).status,
                                "onUpdate:modelValue": ($event) => unref(form).status = $event,
                                items: statusOptions,
                                placeholder: "Select status"
                              }, null, 8, ["modelValue", "onUpdate:modelValue"])
                            ]),
                            _: 1
                          }),
                          createVNode(_component_UFormGroup, {
                            label: "Priority",
                            name: "priority"
                          }, {
                            default: withCtx(() => [
                              createVNode("p", { class: "text-base text-gray-900" }, toDisplayString(unref(ticket)?.priority || "-"), 1)
                            ]),
                            _: 1
                          }),
                          createVNode(_component_UFormGroup, {
                            label: "Assign technician",
                            name: "technician"
                          }, {
                            default: withCtx(() => [
                              createVNode("p", { class: "text-base text-gray-900" }, toDisplayString(unref(assignedTechnician)?.username || unref(assignedTechnician)?.email || unref(ticket)?.technician?.username || unref(ticket)?.technician?.name || unref(ticket)?.technician_name || "Unassigned"), 1)
                            ]),
                            _: 1
                          }),
                          createVNode("div", { class: "space-y-1" }, [
                            createVNode("p", { class: "text-xs text-muted-500" }, "Category"),
                            createVNode("p", { class: "text-base text-gray-900" }, toDisplayString(unref(ticket)?.category?.name || "-"), 1)
                          ]),
                          createVNode("div", { class: "space-y-1 sm:col-span-2" }, [
                            createVNode("p", { class: "text-xs text-muted-500" }, "Description"),
                            createVNode("p", { class: "text-base text-gray-900 whitespace-pre-line" }, toDisplayString(unref(ticket)?.description || "-"), 1)
                          ]),
                          createVNode("div", { class: "sm:col-span-2 flex justify-end gap-3 pt-2" }, [
                            createVNode(_component_UButton, {
                              type: "button",
                              color: "neutral",
                              variant: "ghost",
                              onClick: toggleEdit
                            }, {
                              default: withCtx(() => [
                                createTextVNode("Cancel")
                              ]),
                              _: 1
                            }),
                            createVNode(_component_UButton, {
                              type: "button",
                              color: "primary",
                              icon: "i-lucide-check",
                              loading: unref(isSubmitting),
                              disabled: unref(isSubmitting),
                              onClick: handleSave
                            }, {
                              default: withCtx(() => [
                                createTextVNode(" Save Changes ")
                              ]),
                              _: 1
                            }, 8, ["loading", "disabled"])
                          ])
                        ], 64))
                      ]),
                      _: 1
                    }, 8, ["loading"]),
                    createVNode(__nuxt_component_7, { "ticket-id": unref(ticketId) }, null, 8, ["ticket-id"]),
                    unref(error) ? (openBlock(), createBlock(_component_UAlert, {
                      key: 0,
                      icon: "i-lucide-alert-triangle",
                      color: "red",
                      variant: "soft",
                      title: "Unable to load ticket",
                      description: unref(error)?.message || "Please try again."
                    }, null, 8, ["description"])) : createCommentVNode("", true)
                  ])
                ]),
                _: 1
              })
            ];
          }
        }),
        _: 1
      }, _parent));
    };
  }
});
const _sfc_setup = _sfc_main.setup;
_sfc_main.setup = (props, ctx) => {
  const ssrContext = useSSRContext();
  (ssrContext.modules || (ssrContext.modules = /* @__PURE__ */ new Set())).add("pages/supervisor/tickets/[id].vue");
  return _sfc_setup ? _sfc_setup(props, ctx) : void 0;
};

export { _sfc_main as default };
//# sourceMappingURL=_id_-B6eDN_50.mjs.map
