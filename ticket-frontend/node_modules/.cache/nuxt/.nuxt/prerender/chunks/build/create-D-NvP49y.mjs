import { _ as _sfc_main$e, a as __nuxt_component_1, b as __nuxt_component_2 } from './navbar-DByaTdfk.mjs';
import { _ as _sfc_main$2 } from './Input-u_sFkXpR.mjs';
import { defineComponent, reactive, ref, watch, resolveComponent, withCtx, createVNode, createBlock, createCommentVNode, openBlock, Fragment, renderList, toDisplayString, createTextVNode, withModifiers, useSlots, computed, useTemplateRef, nextTick, unref, mergeProps, renderSlot, useSSRContext } from 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/vue/index.mjs';
import { ssrRenderComponent, ssrRenderList, ssrInterpolate, ssrRenderClass, ssrRenderAttr, ssrRenderAttrs, ssrRenderSlot } from 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/vue/server-renderer/index.mjs';
import { Primitive } from 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/reka-ui/dist/index.js';
import { useVModel } from 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/@vueuse/core/dist/index.js';
import { b as _sfc_main$4, m as useFormField, r as useComponentIcons, t as tv, _ as _sfc_main$3$1, c as _sfc_main$1$1, y as looseToNumber } from './usePortal-BKdXuyUd.mjs';
import { e as useRouter, a as useAppConfig, b as useCookie } from './server.mjs';
import { _ as _sfc_main$3 } from './Select-Dv6KDMrI.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/defu/dist/defu.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/vaul-vue/dist/index.js';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/reka-ui/dist/namespaced/index.mjs';
import './nuxt-link-Bj7IzWuU.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/ufo/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/ohash/dist/utils/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/tailwind-variants/dist/index.js';
import './index-Db0gMLsE.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/@iconify/vue/dist/iconify.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/@iconify/utils/lib/css/icon.js';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/perfect-debounce/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/ofetch/dist/node.mjs';
import '../nitro/nitro.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/h3/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/destr/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/hookable/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/node-mock-http/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/unstorage/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/unstorage/drivers/fs.mjs';
import 'node:crypto';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/unstorage/drivers/fs-lite.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/unstorage/drivers/lru-cache.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/ohash/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/klona/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/scule/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/unctx/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/radix3/dist/index.mjs';
import 'node:fs';
import 'node:url';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/pathe/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/@iconify/utils/lib/index.js';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/consola/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/vue-router/vue-router.node.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/nuxt/node_modules/cookie-es/dist/index.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/tailwindcss/dist/colors.mjs';
import '../_/renderer.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/vue-bundle-renderer/dist/runtime.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/unhead/dist/server.mjs';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/devalue/index.js';
import 'file:///home/mkobaa/workspace/HelpDeskApp/ticket-frontend/node_modules/unhead/dist/utils.mjs';

const theme = {
  "slots": {
    "root": "relative inline-flex items-center",
    "base": [
      "w-full rounded-md border-0 appearance-none placeholder:text-dimmed focus:outline-none disabled:cursor-not-allowed disabled:opacity-75",
      "transition-colors"
    ],
    "leading": "absolute start-0 flex items-start",
    "leadingIcon": "shrink-0 text-dimmed",
    "leadingAvatar": "shrink-0",
    "leadingAvatarSize": "",
    "trailing": "absolute end-0 flex items-start",
    "trailingIcon": "shrink-0 text-dimmed"
  },
  "variants": {
    "fieldGroup": {
      "horizontal": {
        "root": "group has-focus-visible:z-[1]",
        "base": "group-not-only:group-first:rounded-e-none group-not-only:group-last:rounded-s-none group-not-last:group-not-first:rounded-none"
      },
      "vertical": {
        "root": "group has-focus-visible:z-[1]",
        "base": "group-not-only:group-first:rounded-b-none group-not-only:group-last:rounded-t-none group-not-last:group-not-first:rounded-none"
      }
    },
    "size": {
      "xs": {
        "base": "px-2 py-1 text-xs gap-1",
        "leading": "ps-2 inset-y-1",
        "trailing": "pe-2 inset-y-1",
        "leadingIcon": "size-4",
        "leadingAvatarSize": "3xs",
        "trailingIcon": "size-4"
      },
      "sm": {
        "base": "px-2.5 py-1.5 text-xs gap-1.5",
        "leading": "ps-2.5 inset-y-1.5",
        "trailing": "pe-2.5 inset-y-1.5",
        "leadingIcon": "size-4",
        "leadingAvatarSize": "3xs",
        "trailingIcon": "size-4"
      },
      "md": {
        "base": "px-2.5 py-1.5 text-sm gap-1.5",
        "leading": "ps-2.5 inset-y-1.5",
        "trailing": "pe-2.5 inset-y-1.5",
        "leadingIcon": "size-5",
        "leadingAvatarSize": "2xs",
        "trailingIcon": "size-5"
      },
      "lg": {
        "base": "px-3 py-2 text-sm gap-2",
        "leading": "ps-3 inset-y-2",
        "trailing": "pe-3 inset-y-2",
        "leadingIcon": "size-5",
        "leadingAvatarSize": "2xs",
        "trailingIcon": "size-5"
      },
      "xl": {
        "base": "px-3 py-2 text-base gap-2",
        "leading": "ps-3 inset-y-2",
        "trailing": "pe-3 inset-y-2",
        "leadingIcon": "size-6",
        "leadingAvatarSize": "xs",
        "trailingIcon": "size-6"
      }
    },
    "variant": {
      "outline": "text-highlighted bg-default ring ring-inset ring-accented",
      "soft": "text-highlighted bg-elevated/50 hover:bg-elevated focus:bg-elevated disabled:bg-elevated/50",
      "subtle": "text-highlighted bg-elevated ring ring-inset ring-accented",
      "ghost": "text-highlighted bg-transparent hover:bg-elevated focus:bg-elevated disabled:bg-transparent dark:disabled:bg-transparent",
      "none": "text-highlighted bg-transparent"
    },
    "color": {
      "primary": "",
      "secondary": "",
      "success": "",
      "info": "",
      "warning": "",
      "error": "",
      "neutral": ""
    },
    "leading": {
      "true": ""
    },
    "trailing": {
      "true": ""
    },
    "loading": {
      "true": ""
    },
    "highlight": {
      "true": ""
    },
    "type": {
      "file": "file:me-1.5 file:font-medium file:text-muted file:outline-none"
    },
    "autoresize": {
      "true": {
        "base": "resize-none"
      }
    }
  },
  "compoundVariants": [
    {
      "color": "primary",
      "variant": [
        "outline",
        "subtle"
      ],
      "class": "focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-primary"
    },
    {
      "color": "secondary",
      "variant": [
        "outline",
        "subtle"
      ],
      "class": "focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-secondary"
    },
    {
      "color": "success",
      "variant": [
        "outline",
        "subtle"
      ],
      "class": "focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-success"
    },
    {
      "color": "info",
      "variant": [
        "outline",
        "subtle"
      ],
      "class": "focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-info"
    },
    {
      "color": "warning",
      "variant": [
        "outline",
        "subtle"
      ],
      "class": "focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-warning"
    },
    {
      "color": "error",
      "variant": [
        "outline",
        "subtle"
      ],
      "class": "focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-error"
    },
    {
      "color": "primary",
      "highlight": true,
      "class": "ring ring-inset ring-primary"
    },
    {
      "color": "secondary",
      "highlight": true,
      "class": "ring ring-inset ring-secondary"
    },
    {
      "color": "success",
      "highlight": true,
      "class": "ring ring-inset ring-success"
    },
    {
      "color": "info",
      "highlight": true,
      "class": "ring ring-inset ring-info"
    },
    {
      "color": "warning",
      "highlight": true,
      "class": "ring ring-inset ring-warning"
    },
    {
      "color": "error",
      "highlight": true,
      "class": "ring ring-inset ring-error"
    },
    {
      "color": "neutral",
      "variant": [
        "outline",
        "subtle"
      ],
      "class": "focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-inverted"
    },
    {
      "color": "neutral",
      "highlight": true,
      "class": "ring ring-inset ring-inverted"
    },
    {
      "leading": true,
      "size": "xs",
      "class": "ps-7"
    },
    {
      "leading": true,
      "size": "sm",
      "class": "ps-8"
    },
    {
      "leading": true,
      "size": "md",
      "class": "ps-9"
    },
    {
      "leading": true,
      "size": "lg",
      "class": "ps-10"
    },
    {
      "leading": true,
      "size": "xl",
      "class": "ps-11"
    },
    {
      "trailing": true,
      "size": "xs",
      "class": "pe-7"
    },
    {
      "trailing": true,
      "size": "sm",
      "class": "pe-8"
    },
    {
      "trailing": true,
      "size": "md",
      "class": "pe-9"
    },
    {
      "trailing": true,
      "size": "lg",
      "class": "pe-10"
    },
    {
      "trailing": true,
      "size": "xl",
      "class": "pe-11"
    },
    {
      "loading": true,
      "leading": true,
      "class": {
        "leadingIcon": "animate-spin"
      }
    },
    {
      "loading": true,
      "leading": false,
      "trailing": true,
      "class": {
        "trailingIcon": "animate-spin"
      }
    }
  ],
  "defaultVariants": {
    "size": "md",
    "color": "primary",
    "variant": "outline"
  }
};
const _sfc_main$1 = /* @__PURE__ */ Object.assign({ inheritAttrs: false }, {
  __name: "UTextarea",
  __ssrInlineRender: true,
  props: {
    as: { type: null, required: false },
    id: { type: String, required: false },
    name: { type: String, required: false },
    placeholder: { type: String, required: false },
    color: { type: null, required: false },
    variant: { type: null, required: false },
    size: { type: null, required: false },
    required: { type: Boolean, required: false },
    autofocus: { type: Boolean, required: false },
    autofocusDelay: { type: Number, required: false, default: 0 },
    autoresize: { type: Boolean, required: false },
    autoresizeDelay: { type: Number, required: false, default: 0 },
    disabled: { type: Boolean, required: false },
    rows: { type: Number, required: false, default: 3 },
    maxrows: { type: Number, required: false, default: 0 },
    highlight: { type: Boolean, required: false },
    modelValue: { type: null, required: false },
    defaultValue: { type: null, required: false },
    modelModifiers: { type: Object, required: false },
    class: { type: null, required: false },
    ui: { type: null, required: false },
    icon: { type: null, required: false },
    avatar: { type: Object, required: false },
    leading: { type: Boolean, required: false },
    leadingIcon: { type: null, required: false },
    trailing: { type: Boolean, required: false },
    trailingIcon: { type: null, required: false },
    loading: { type: Boolean, required: false },
    loadingIcon: { type: null, required: false }
  },
  emits: ["update:modelValue", "blur", "change"],
  setup(__props, { expose: __expose, emit: __emit }) {
    const props = __props;
    const emits = __emit;
    const slots = useSlots();
    const modelValue = useVModel(props, "modelValue", emits, { defaultValue: props.defaultValue });
    const appConfig = useAppConfig();
    const { emitFormFocus, emitFormBlur, emitFormInput, emitFormChange, size, color, id, name, highlight, disabled, ariaAttrs } = useFormField(props, { deferInputValidation: true });
    const { isLeading, isTrailing, leadingIconName, trailingIconName } = useComponentIcons(props);
    const ui = computed(() => tv({ extend: tv(theme), ...appConfig.ui?.textarea || {} })({
      color: color.value,
      variant: props.variant,
      size: size?.value,
      loading: props.loading,
      highlight: highlight.value,
      autoresize: props.autoresize,
      leading: isLeading.value || !!props.avatar || !!slots.leading,
      trailing: isTrailing.value || !!slots.trailing
    }));
    const textareaRef = useTemplateRef("textareaRef");
    function updateInput(value) {
      if (props.modelModifiers?.trim) {
        value = value?.trim() ?? null;
      }
      if (props.modelModifiers?.number) {
        value = looseToNumber(value);
      }
      if (props.modelModifiers?.nullable) {
        value ||= null;
      }
      if (props.modelModifiers?.optional) {
        value ||= void 0;
      }
      modelValue.value = value;
      emitFormInput();
    }
    function onInput(event) {
      autoResize();
      if (!props.modelModifiers?.lazy) {
        updateInput(event.target.value);
      }
    }
    function onChange(event) {
      const value = event.target.value;
      if (props.modelModifiers?.lazy) {
        updateInput(value);
      }
      if (props.modelModifiers?.trim) {
        event.target.value = value.trim();
      }
      emitFormChange();
      emits("change", event);
    }
    function onBlur(event) {
      emitFormBlur();
      emits("blur", event);
    }
    function autoResize() {
      if (props.autoresize && textareaRef.value) {
        textareaRef.value.rows = props.rows;
        const overflow = textareaRef.value.style.overflow;
        textareaRef.value.style.overflow = "hidden";
        const styles = (void 0).getComputedStyle(textareaRef.value);
        const paddingTop = Number.parseInt(styles.paddingTop);
        const paddingBottom = Number.parseInt(styles.paddingBottom);
        const padding = paddingTop + paddingBottom;
        const lineHeight = Number.parseInt(styles.lineHeight);
        const { scrollHeight } = textareaRef.value;
        const newRows = (scrollHeight - padding) / lineHeight;
        if (newRows > props.rows) {
          textareaRef.value.rows = props.maxrows ? Math.min(newRows, props.maxrows) : newRows;
        }
        textareaRef.value.style.overflow = overflow;
      }
    }
    watch(modelValue, () => {
      nextTick(autoResize);
    });
    __expose({
      textareaRef
    });
    return (_ctx, _push, _parent, _attrs) => {
      let _temp0;
      _push(ssrRenderComponent(unref(Primitive), mergeProps({
        as: __props.as,
        "data-slot": "root",
        class: ui.value.root({ class: [props.ui?.root, props.class] })
      }, _attrs), {
        default: withCtx((_, _push2, _parent2, _scopeId) => {
          if (_push2) {
            _push2(`<textarea${ssrRenderAttrs(_temp0 = mergeProps({
              id: unref(id),
              ref_key: "textareaRef",
              ref: textareaRef,
              value: unref(modelValue),
              name: unref(name),
              rows: __props.rows,
              placeholder: __props.placeholder,
              "data-slot": "base",
              class: ui.value.base({ class: props.ui?.base }),
              disabled: unref(disabled),
              required: __props.required
            }, { ..._ctx.$attrs, ...unref(ariaAttrs) }), "textarea")}${_scopeId}>${ssrInterpolate("value" in _temp0 ? _temp0.value : "")}</textarea>`);
            ssrRenderSlot(_ctx.$slots, "default", { ui: ui.value }, null, _push2, _parent2, _scopeId);
            if (unref(isLeading) || !!__props.avatar || !!slots.leading) {
              _push2(`<span data-slot="leading" class="${ssrRenderClass(ui.value.leading({ class: props.ui?.leading }))}"${_scopeId}>`);
              ssrRenderSlot(_ctx.$slots, "leading", { ui: ui.value }, () => {
                if (unref(isLeading) && unref(leadingIconName)) {
                  _push2(ssrRenderComponent(_sfc_main$3$1, {
                    name: unref(leadingIconName),
                    "data-slot": "leadingIcon",
                    class: ui.value.leadingIcon({ class: props.ui?.leadingIcon })
                  }, null, _parent2, _scopeId));
                } else if (!!__props.avatar) {
                  _push2(ssrRenderComponent(_sfc_main$1$1, mergeProps({
                    size: props.ui?.leadingAvatarSize || ui.value.leadingAvatarSize()
                  }, __props.avatar, {
                    "data-slot": "leadingAvatar",
                    class: ui.value.leadingAvatar({ class: props.ui?.leadingAvatar })
                  }), null, _parent2, _scopeId));
                } else {
                  _push2(`<!---->`);
                }
              }, _push2, _parent2, _scopeId);
              _push2(`</span>`);
            } else {
              _push2(`<!---->`);
            }
            if (unref(isTrailing) || !!slots.trailing) {
              _push2(`<span data-slot="trailing" class="${ssrRenderClass(ui.value.trailing({ class: props.ui?.trailing }))}"${_scopeId}>`);
              ssrRenderSlot(_ctx.$slots, "trailing", { ui: ui.value }, () => {
                if (unref(trailingIconName)) {
                  _push2(ssrRenderComponent(_sfc_main$3$1, {
                    name: unref(trailingIconName),
                    "data-slot": "trailingIcon",
                    class: ui.value.trailingIcon({ class: props.ui?.trailingIcon })
                  }, null, _parent2, _scopeId));
                } else {
                  _push2(`<!---->`);
                }
              }, _push2, _parent2, _scopeId);
              _push2(`</span>`);
            } else {
              _push2(`<!---->`);
            }
          } else {
            return [
              createVNode("textarea", mergeProps({
                id: unref(id),
                ref_key: "textareaRef",
                ref: textareaRef,
                value: unref(modelValue),
                name: unref(name),
                rows: __props.rows,
                placeholder: __props.placeholder,
                "data-slot": "base",
                class: ui.value.base({ class: props.ui?.base }),
                disabled: unref(disabled),
                required: __props.required
              }, { ..._ctx.$attrs, ...unref(ariaAttrs) }, {
                onInput,
                onBlur,
                onChange,
                onFocus: unref(emitFormFocus)
              }), null, 16, ["id", "value", "name", "rows", "placeholder", "disabled", "required", "onFocus"]),
              renderSlot(_ctx.$slots, "default", { ui: ui.value }),
              unref(isLeading) || !!__props.avatar || !!slots.leading ? (openBlock(), createBlock("span", {
                key: 0,
                "data-slot": "leading",
                class: ui.value.leading({ class: props.ui?.leading })
              }, [
                renderSlot(_ctx.$slots, "leading", { ui: ui.value }, () => [
                  unref(isLeading) && unref(leadingIconName) ? (openBlock(), createBlock(_sfc_main$3$1, {
                    key: 0,
                    name: unref(leadingIconName),
                    "data-slot": "leadingIcon",
                    class: ui.value.leadingIcon({ class: props.ui?.leadingIcon })
                  }, null, 8, ["name", "class"])) : !!__props.avatar ? (openBlock(), createBlock(_sfc_main$1$1, mergeProps({
                    key: 1,
                    size: props.ui?.leadingAvatarSize || ui.value.leadingAvatarSize()
                  }, __props.avatar, {
                    "data-slot": "leadingAvatar",
                    class: ui.value.leadingAvatar({ class: props.ui?.leadingAvatar })
                  }), null, 16, ["size", "class"])) : createCommentVNode("", true)
                ])
              ], 2)) : createCommentVNode("", true),
              unref(isTrailing) || !!slots.trailing ? (openBlock(), createBlock("span", {
                key: 1,
                "data-slot": "trailing",
                class: ui.value.trailing({ class: props.ui?.trailing })
              }, [
                renderSlot(_ctx.$slots, "trailing", { ui: ui.value }, () => [
                  unref(trailingIconName) ? (openBlock(), createBlock(_sfc_main$3$1, {
                    key: 0,
                    name: unref(trailingIconName),
                    "data-slot": "trailingIcon",
                    class: ui.value.trailingIcon({ class: props.ui?.trailingIcon })
                  }, null, 8, ["name", "class"])) : createCommentVNode("", true)
                ])
              ], 2)) : createCommentVNode("", true)
            ];
          }
        }),
        _: 3
      }, _parent));
    };
  }
});
const _sfc_setup$1 = _sfc_main$1.setup;
_sfc_main$1.setup = (props, ctx) => {
  const ssrContext = useSSRContext();
  (ssrContext.modules || (ssrContext.modules = /* @__PURE__ */ new Set())).add("../node_modules/@nuxt/ui/dist/runtime/components/Textarea.vue");
  return _sfc_setup$1 ? _sfc_setup$1(props, ctx) : void 0;
};
const suggestCategories = async (q) => {
  const token = useCookie("auth_token");
  let bearer = token.value || "";
  try {
    bearer = decodeURIComponent(bearer);
  } catch {
  }
  if (!q || String(q).length < 2) return [];
  const url = `http://localhost:8000/api/categories/suggest?q=${encodeURIComponent(q)}`;
  const response = await fetch(url, {
    method: "GET",
    headers: {
      Accept: "application/json",
      "Content-Type": "application/json",
      Authorization: `Bearer ${bearer}`
    }
  });
  const raw = await response.json();
  if (!response.ok) throw raw;
  if (Array.isArray(raw)) return raw;
  if (Array.isArray(raw.data)) return raw.data;
  if (Array.isArray(raw.categories)) return raw.categories;
  return [];
};
const createTicket = async ({ title, description, priority, status, category_id, submitter_id, assigned_to_id, attachments }) => {
  const token = useCookie("auth_token");
  let bearer = token.value || "";
  try {
    bearer = decodeURIComponent(bearer);
  } catch {
  }
  const role = useCookie("user_role").value;
  const allowedRoles = ["user", "technician", "supervisor", "admin"];
  if (role && !allowedRoles.includes(role)) {
    throw new Error("Invalid role. Allowed roles: user, technician, supervisor, admin");
  }
  const formData = new FormData();
  formData.append("title", title);
  if (description) formData.append("description", description);
  formData.append("priority", priority);
  if (status) formData.append("status", status);
  if (category_id) formData.append("category_id", category_id);
  if (submitter_id) formData.append("submitter_id", submitter_id);
  if (assigned_to_id) formData.append("assigned_tech_id", assigned_to_id);
  if (attachments && attachments.length) {
    attachments.forEach((file) => {
      formData.append("attachments[]", file);
    });
  }
  const response = await fetch("http://localhost:8000/api/tickets", {
    method: "POST",
    headers: {
      Accept: "application/json",
      Authorization: `Bearer ${bearer}`
      // Note: Do not set Content-Type, browser will set it with boundary
    },
    body: formData
  });
  const data = await response.json();
  if (!response.ok) {
    throw data;
  }
  return data;
};
const _sfc_main = /* @__PURE__ */ defineComponent({
  __name: "create",
  __ssrInlineRender: true,
  setup(__props) {
    const form = reactive({
      title: "",
      description: "",
      priority: "",
      status: "",
      category_id: null,
      submitter_id: null,
      assigned_to_id: null
    });
    const priorityOptions = ref([
      "low",
      "medium",
      "critical"
    ]);
    const isSubmitting = ref(false);
    const router = useRouter();
    const attachments = ref([]);
    const previews = ref([]);
    const dragActive = ref(false);
    const uploadError = ref("");
    const categorySearch = ref("");
    const categoryOptions = ref([]);
    const categoryLoading = ref(false);
    let categoryDebounce = null;
    const selectedCategoryId = ref(null);
    const selectedCategoryName = ref("");
    let titleDebounce = null;
    const updatePreviews = () => {
      previews.value = attachments.value.map((file) => {
        if (file.type.startsWith("image/")) {
          return { url: URL.createObjectURL(file), type: "image", name: file.name };
        } else if (file.type === "application/pdf") {
          return { url: URL.createObjectURL(file), type: "pdf", name: file.name };
        }
        return { url: "", type: "other", name: file.name };
      });
    };
    const handleFileChange = (event) => {
      const files = Array.from(event.target.files || []);
      const invalid = files.find((f) => f.size > 10 * 1024 * 1024);
      if (invalid) {
        uploadError.value = "Each file must be less than 10MB.";
        attachments.value = [];
        previews.value = [];
        return;
      }
      uploadError.value = "";
      attachments.value = files;
      updatePreviews();
    };
    const handleDrop = (event) => {
      event.preventDefault();
      dragActive.value = false;
      if (event.dataTransfer?.files) {
        const files = Array.from(event.dataTransfer.files);
        const invalid = files.find((f) => f.size > 10 * 1024 * 1024);
        if (invalid) {
          uploadError.value = "Each file must be less than 10MB.";
          attachments.value = [];
          previews.value = [];
          return;
        }
        uploadError.value = "";
        attachments.value = files;
        updatePreviews();
      }
    };
    const handleDragOver = (event) => {
      event.preventDefault();
      dragActive.value = true;
    };
    const handleDragLeave = (event) => {
      event.preventDefault();
      dragActive.value = false;
    };
    const searchCategories = async (q) => {
      if (!q || q.length < 2) {
        categoryOptions.value = [];
        return;
      }
      categoryLoading.value = true;
      try {
        const res = await suggestCategories(q);
        categoryOptions.value = Array.isArray(res) ? res : res.data || res.categories || [];
      } catch (err) {
        categoryOptions.value = [];
      } finally {
        categoryLoading.value = false;
      }
    };
    const onCategoryInput = (e) => {
      categorySearch.value = e.target.value;
      selectedCategoryId.value = null;
      selectedCategoryName.value = "";
      if (categoryDebounce) clearTimeout(categoryDebounce);
      categoryDebounce = setTimeout(() => searchCategories(categorySearch.value), 300);
    };
    watch(() => form.title, (val) => {
      if (selectedCategoryId.value) return;
      if (titleDebounce) clearTimeout(titleDebounce);
      titleDebounce = setTimeout(() => {
        if (val && String(val).length >= 2) {
          searchCategories(String(val));
        } else {
          categoryOptions.value = [];
        }
      }, 300);
    });
    const selectCategory = (c) => {
      const id = c?.id ?? c?.value ?? null;
      selectedCategoryId.value = id;
      selectedCategoryName.value = c?.name || c?.title || c?.label || "";
      form.category_id = id;
      categorySearch.value = selectedCategoryName.value;
      categoryOptions.value = [];
    };
    const clearCategory = () => {
      selectedCategoryId.value = null;
      selectedCategoryName.value = "";
      categorySearch.value = "";
      form.category_id = null;
      categoryOptions.value = [];
    };
    const handleCreate = async () => {
      if (isSubmitting.value) return;
      isSubmitting.value = true;
      try {
        await createTicket({
          title: form.title,
          description: form.description,
          priority: form.priority,
          status: form.status,
          category_id: selectedCategoryId.value ?? null,
          submitter_id: form.submitter_id,
          assigned_to_id: form.assigned_to_id,
          attachments: attachments.value
        });
        await router.push("/user/tickets");
      } catch (error) {
        console.error("Failed to create ticket", error);
      } finally {
        isSubmitting.value = false;
      }
    };
    return (_ctx, _push, _parent, _attrs) => {
      const _component_UDashboardGroup = _sfc_main$e;
      const _component_Sidebar = __nuxt_component_1;
      const _component_UDashboardPage = resolveComponent("UDashboardPage");
      const _component_Navbar = __nuxt_component_2;
      const _component_UFormGroup = resolveComponent("UFormGroup");
      const _component_UInput = _sfc_main$2;
      const _component_UTextarea = _sfc_main$1;
      const _component_USelect = _sfc_main$3;
      const _component_UButton = _sfc_main$4;
      _push(ssrRenderComponent(_component_UDashboardGroup, _attrs, {
        default: withCtx((_, _push2, _parent2, _scopeId) => {
          if (_push2) {
            _push2(ssrRenderComponent(_component_Sidebar, null, null, _parent2, _scopeId));
            _push2(ssrRenderComponent(_component_UDashboardPage, { class: "flex flex-col flex-1 min-w-0 overflow-hidden" }, {
              default: withCtx((_2, _push3, _parent3, _scopeId2) => {
                if (_push3) {
                  _push3(ssrRenderComponent(_component_Navbar, {
                    title: "Create ticket",
                    icon: "i-lucide-ticket-plus",
                    class: "w-full"
                  }, null, _parent3, _scopeId2));
                  _push3(`<div class="flex flex-col flex-1 gap-6 p-6 overflow-auto"${_scopeId2}><form class="flex flex-col gap-4 max-w-3xl w-full"${_scopeId2}><div class="grid grid-cols-1 gap-4 sm:grid-cols-2"${_scopeId2}>`);
                  _push3(ssrRenderComponent(_component_UFormGroup, {
                    label: "Title",
                    name: "title"
                  }, {
                    default: withCtx((_3, _push4, _parent4, _scopeId3) => {
                      if (_push4) {
                        _push4(ssrRenderComponent(_component_UInput, {
                          modelValue: form.title,
                          "onUpdate:modelValue": ($event) => form.title = $event,
                          placeholder: "Ticket Title",
                          required: "",
                          maxlength: "255"
                        }, null, _parent4, _scopeId3));
                      } else {
                        return [
                          createVNode(_component_UInput, {
                            modelValue: form.title,
                            "onUpdate:modelValue": ($event) => form.title = $event,
                            placeholder: "Ticket Title",
                            required: "",
                            maxlength: "255"
                          }, null, 8, ["modelValue", "onUpdate:modelValue"])
                        ];
                      }
                    }),
                    _: 1
                  }, _parent3, _scopeId2));
                  _push3(ssrRenderComponent(_component_UFormGroup, {
                    label: "Description",
                    name: "description",
                    class: "sm:col-span-2"
                  }, {
                    default: withCtx((_3, _push4, _parent4, _scopeId3) => {
                      if (_push4) {
                        _push4(ssrRenderComponent(_component_UTextarea, {
                          modelValue: form.description,
                          "onUpdate:modelValue": ($event) => form.description = $event,
                          placeholder: "Ticket Description",
                          rows: "6",
                          class: "min-h-32 resize-vertical",
                          maxlength: "2000"
                        }, null, _parent4, _scopeId3));
                        _push4(`<p class="text-xs text-muted mt-1"${_scopeId3}>Provide a clear, detailed description (max 2000 characters).</p>`);
                      } else {
                        return [
                          createVNode(_component_UTextarea, {
                            modelValue: form.description,
                            "onUpdate:modelValue": ($event) => form.description = $event,
                            placeholder: "Ticket Description",
                            rows: "6",
                            class: "min-h-32 resize-vertical",
                            maxlength: "2000"
                          }, null, 8, ["modelValue", "onUpdate:modelValue"]),
                          createVNode("p", { class: "text-xs text-muted mt-1" }, "Provide a clear, detailed description (max 2000 characters).")
                        ];
                      }
                    }),
                    _: 1
                  }, _parent3, _scopeId2));
                  _push3(ssrRenderComponent(_component_UFormGroup, {
                    label: "Priority",
                    name: "priority"
                  }, {
                    default: withCtx((_3, _push4, _parent4, _scopeId3) => {
                      if (_push4) {
                        _push4(ssrRenderComponent(_component_USelect, {
                          modelValue: form.priority,
                          "onUpdate:modelValue": ($event) => form.priority = $event,
                          items: priorityOptions.value,
                          placeholder: "Select priority"
                        }, null, _parent4, _scopeId3));
                      } else {
                        return [
                          createVNode(_component_USelect, {
                            modelValue: form.priority,
                            "onUpdate:modelValue": ($event) => form.priority = $event,
                            items: priorityOptions.value,
                            placeholder: "Select priority"
                          }, null, 8, ["modelValue", "onUpdate:modelValue", "items"])
                        ];
                      }
                    }),
                    _: 1
                  }, _parent3, _scopeId2));
                  _push3(ssrRenderComponent(_component_UFormGroup, {
                    label: "Category",
                    name: "category_id",
                    class: "sm:col-span-2"
                  }, {
                    default: withCtx((_3, _push4, _parent4, _scopeId3) => {
                      if (_push4) {
                        _push4(`<div class="relative"${_scopeId3}>`);
                        _push4(ssrRenderComponent(_component_UInput, {
                          value: categorySearch.value,
                          placeholder: "Search categories by name",
                          onInput: onCategoryInput,
                          "aria-label": "Search categories"
                        }, null, _parent4, _scopeId3));
                        if (categoryLoading.value) {
                          _push4(`<div class="absolute right-2 top-2 text-xs text-muted"${_scopeId3}>Searching...</div>`);
                        } else {
                          _push4(`<!---->`);
                        }
                        if (categoryOptions.value.length) {
                          _push4(`<ul class="absolute z-50 mt-1 w-full bg-white border rounded-md shadow-sm max-h-48 overflow-auto"${_scopeId3}><!--[-->`);
                          ssrRenderList(categoryOptions.value, (opt) => {
                            _push4(`<li class="px-3 py-2 hover:bg-gray-100 cursor-pointer"${_scopeId3}>${ssrInterpolate(opt.name || opt.title || opt.label || opt.value)}</li>`);
                          });
                          _push4(`<!--]--></ul>`);
                        } else if (categorySearch.value.length >= 2 && !categoryLoading.value) {
                          _push4(`<div class="absolute z-50 mt-1 w-full bg-white border rounded-md shadow-sm px-3 py-2 text-sm text-muted"${_scopeId3}>No matching category</div>`);
                        } else {
                          _push4(`<!---->`);
                        }
                        if (selectedCategoryId.value) {
                          _push4(`<div class="absolute right-2 top-2"${_scopeId3}><button type="button" class="text-xs text-muted hover:text-gray-700"${_scopeId3}>Clear</button></div>`);
                        } else {
                          _push4(`<!---->`);
                        }
                        _push4(`</div><p class="text-xs text-muted mt-1"${_scopeId3}>Choose a category for the ticket. Selected: <span class="font-medium"${_scopeId3}>${ssrInterpolate(selectedCategoryName.value || (form.category_id ? form.category_id : "none"))}</span></p>`);
                      } else {
                        return [
                          createVNode("div", { class: "relative" }, [
                            createVNode(_component_UInput, {
                              value: categorySearch.value,
                              placeholder: "Search categories by name",
                              onInput: onCategoryInput,
                              "aria-label": "Search categories"
                            }, null, 8, ["value"]),
                            categoryLoading.value ? (openBlock(), createBlock("div", {
                              key: 0,
                              class: "absolute right-2 top-2 text-xs text-muted"
                            }, "Searching...")) : createCommentVNode("", true),
                            categoryOptions.value.length ? (openBlock(), createBlock("ul", {
                              key: 1,
                              class: "absolute z-50 mt-1 w-full bg-white border rounded-md shadow-sm max-h-48 overflow-auto"
                            }, [
                              (openBlock(true), createBlock(Fragment, null, renderList(categoryOptions.value, (opt) => {
                                return openBlock(), createBlock("li", {
                                  key: opt.id || opt.value,
                                  class: "px-3 py-2 hover:bg-gray-100 cursor-pointer",
                                  onClick: ($event) => selectCategory(opt)
                                }, toDisplayString(opt.name || opt.title || opt.label || opt.value), 9, ["onClick"]);
                              }), 128))
                            ])) : categorySearch.value.length >= 2 && !categoryLoading.value ? (openBlock(), createBlock("div", {
                              key: 2,
                              class: "absolute z-50 mt-1 w-full bg-white border rounded-md shadow-sm px-3 py-2 text-sm text-muted"
                            }, "No matching category")) : createCommentVNode("", true),
                            selectedCategoryId.value ? (openBlock(), createBlock("div", {
                              key: 3,
                              class: "absolute right-2 top-2"
                            }, [
                              createVNode("button", {
                                type: "button",
                                class: "text-xs text-muted hover:text-gray-700",
                                onClick: clearCategory
                              }, "Clear")
                            ])) : createCommentVNode("", true)
                          ]),
                          createVNode("p", { class: "text-xs text-muted mt-1" }, [
                            createTextVNode("Choose a category for the ticket. Selected: "),
                            createVNode("span", { class: "font-medium" }, toDisplayString(selectedCategoryName.value || (form.category_id ? form.category_id : "none")), 1)
                          ])
                        ];
                      }
                    }),
                    _: 1
                  }, _parent3, _scopeId2));
                  _push3(ssrRenderComponent(_component_UFormGroup, {
                    label: "Attachments",
                    name: "attachments",
                    class: "sm:col-span-2"
                  }, {
                    default: withCtx((_3, _push4, _parent4, _scopeId3) => {
                      if (_push4) {
                        _push4(`<div class="${ssrRenderClass([dragActive.value ? "border-primary bg-primary/10" : "border-gray-300 bg-gray-50", "border-2 border-dashed rounded-md p-6 min-h-28 text-center transition-colors cursor-pointer"])}"${_scopeId3}><input type="file" multiple class="hidden"${_scopeId3}><div class="flex flex-col items-center gap-2"${_scopeId3}><span class="i-lucide-upload-cloud text-3xl text-primary"${_scopeId3}></span><span class="font-medium"${_scopeId3}>Drag &amp; drop files here or <span class="underline text-primary cursor-pointer"${_scopeId3}>browse</span></span><span class="text-xs text-muted"${_scopeId3}>Max 10MB.</span></div></div>`);
                        if (uploadError.value) {
                          _push4(`<div class="mt-2 text-sm text-error"${_scopeId3}>${ssrInterpolate(uploadError.value)}</div>`);
                        } else {
                          _push4(`<!---->`);
                        }
                        _push4(`<div class="text-xs text-muted mt-2"${_scopeId3}>You can attach images or PDFs. Max 10MB per file.</div>`);
                        if (attachments.value.length) {
                          _push4(`<div class="mt-3"${_scopeId3}><ul class="divide-y divide-gray-200 bg-white rounded-md shadow-sm"${_scopeId3}><!--[-->`);
                          ssrRenderList(attachments.value, (file, idx) => {
                            _push4(`<li class="flex flex-col gap-2 px-3 py-2"${_scopeId3}><div class="flex items-center gap-2"${_scopeId3}><span class="i-lucide-file text-lg text-gray-400"${_scopeId3}></span><span class="font-medium"${_scopeId3}>${ssrInterpolate(file.name)}</span><span class="text-xs text-muted"${_scopeId3}>(${ssrInterpolate((file.size / 1024 / 1024).toFixed(2))} MB)</span></div>`);
                            if (previews.value[idx]?.type === "image") {
                              _push4(`<div class="mt-1 flex items-center"${_scopeId3}><img${ssrRenderAttr("src", previews.value[idx].url)}${ssrRenderAttr("alt", file.name)} class="max-h-24 rounded border"${_scopeId3}></div>`);
                            } else if (previews.value[idx]?.type === "pdf") {
                              _push4(`<div class="mt-1 flex items-center"${_scopeId3}><embed${ssrRenderAttr("src", previews.value[idx].url)} type="application/pdf" class="max-h-32 w-full border rounded"${_scopeId3}></div>`);
                            } else if (previews.value[idx]?.type === "other") {
                              _push4(`<div class="mt-1 text-xs text-muted"${_scopeId3}> No preview available </div>`);
                            } else {
                              _push4(`<!---->`);
                            }
                            _push4(`</li>`);
                          });
                          _push4(`<!--]--></ul></div>`);
                        } else {
                          _push4(`<!---->`);
                        }
                      } else {
                        return [
                          createVNode("div", {
                            class: ["border-2 border-dashed rounded-md p-6 min-h-28 text-center transition-colors cursor-pointer", dragActive.value ? "border-primary bg-primary/10" : "border-gray-300 bg-gray-50"],
                            onDragover: handleDragOver,
                            onDragleave: handleDragLeave,
                            onDrop: handleDrop,
                            onClick: ($event) => _ctx.$refs.fileInput.click()
                          }, [
                            createVNode("input", {
                              ref: "fileInput",
                              type: "file",
                              multiple: "",
                              class: "hidden",
                              onChange: handleFileChange
                            }, null, 544),
                            createVNode("div", { class: "flex flex-col items-center gap-2" }, [
                              createVNode("span", { class: "i-lucide-upload-cloud text-3xl text-primary" }),
                              createVNode("span", { class: "font-medium" }, [
                                createTextVNode("Drag & drop files here or "),
                                createVNode("span", { class: "underline text-primary cursor-pointer" }, "browse")
                              ]),
                              createVNode("span", { class: "text-xs text-muted" }, "Max 10MB.")
                            ])
                          ], 42, ["onClick"]),
                          uploadError.value ? (openBlock(), createBlock("div", {
                            key: 0,
                            class: "mt-2 text-sm text-error"
                          }, toDisplayString(uploadError.value), 1)) : createCommentVNode("", true),
                          createVNode("div", { class: "text-xs text-muted mt-2" }, "You can attach images or PDFs. Max 10MB per file."),
                          attachments.value.length ? (openBlock(), createBlock("div", {
                            key: 1,
                            class: "mt-3"
                          }, [
                            createVNode("ul", { class: "divide-y divide-gray-200 bg-white rounded-md shadow-sm" }, [
                              (openBlock(true), createBlock(Fragment, null, renderList(attachments.value, (file, idx) => {
                                return openBlock(), createBlock("li", {
                                  key: file.name,
                                  class: "flex flex-col gap-2 px-3 py-2"
                                }, [
                                  createVNode("div", { class: "flex items-center gap-2" }, [
                                    createVNode("span", { class: "i-lucide-file text-lg text-gray-400" }),
                                    createVNode("span", { class: "font-medium" }, toDisplayString(file.name), 1),
                                    createVNode("span", { class: "text-xs text-muted" }, "(" + toDisplayString((file.size / 1024 / 1024).toFixed(2)) + " MB)", 1)
                                  ]),
                                  previews.value[idx]?.type === "image" ? (openBlock(), createBlock("div", {
                                    key: 0,
                                    class: "mt-1 flex items-center"
                                  }, [
                                    createVNode("img", {
                                      src: previews.value[idx].url,
                                      alt: file.name,
                                      class: "max-h-24 rounded border"
                                    }, null, 8, ["src", "alt"])
                                  ])) : previews.value[idx]?.type === "pdf" ? (openBlock(), createBlock("div", {
                                    key: 1,
                                    class: "mt-1 flex items-center"
                                  }, [
                                    createVNode("embed", {
                                      src: previews.value[idx].url,
                                      type: "application/pdf",
                                      class: "max-h-32 w-full border rounded"
                                    }, null, 8, ["src"])
                                  ])) : previews.value[idx]?.type === "other" ? (openBlock(), createBlock("div", {
                                    key: 2,
                                    class: "mt-1 text-xs text-muted"
                                  }, " No preview available ")) : createCommentVNode("", true)
                                ]);
                              }), 128))
                            ])
                          ])) : createCommentVNode("", true)
                        ];
                      }
                    }),
                    _: 1
                  }, _parent3, _scopeId2));
                  _push3(`</div><div class="flex justify-end gap-3 pt-2"${_scopeId2}>`);
                  _push3(ssrRenderComponent(_component_UButton, {
                    color: "neutral",
                    variant: "ghost",
                    to: "/admin/categories"
                  }, {
                    default: withCtx((_3, _push4, _parent4, _scopeId3) => {
                      if (_push4) {
                        _push4(`Cancel`);
                      } else {
                        return [
                          createTextVNode("Cancel")
                        ];
                      }
                    }),
                    _: 1
                  }, _parent3, _scopeId2));
                  _push3(ssrRenderComponent(_component_UButton, {
                    loading: isSubmitting.value,
                    disabled: isSubmitting.value,
                    type: "submit",
                    color: "primary",
                    icon: "i-lucide-check"
                  }, {
                    default: withCtx((_3, _push4, _parent4, _scopeId3) => {
                      if (_push4) {
                        _push4(`Create`);
                      } else {
                        return [
                          createTextVNode("Create")
                        ];
                      }
                    }),
                    _: 1
                  }, _parent3, _scopeId2));
                  _push3(`</div></form></div>`);
                } else {
                  return [
                    createVNode(_component_Navbar, {
                      title: "Create ticket",
                      icon: "i-lucide-ticket-plus",
                      class: "w-full"
                    }),
                    createVNode("div", { class: "flex flex-col flex-1 gap-6 p-6 overflow-auto" }, [
                      createVNode("form", {
                        class: "flex flex-col gap-4 max-w-3xl w-full",
                        onSubmit: withModifiers(handleCreate, ["prevent"])
                      }, [
                        createVNode("div", { class: "grid grid-cols-1 gap-4 sm:grid-cols-2" }, [
                          createVNode(_component_UFormGroup, {
                            label: "Title",
                            name: "title"
                          }, {
                            default: withCtx(() => [
                              createVNode(_component_UInput, {
                                modelValue: form.title,
                                "onUpdate:modelValue": ($event) => form.title = $event,
                                placeholder: "Ticket Title",
                                required: "",
                                maxlength: "255"
                              }, null, 8, ["modelValue", "onUpdate:modelValue"])
                            ]),
                            _: 1
                          }),
                          createVNode(_component_UFormGroup, {
                            label: "Description",
                            name: "description",
                            class: "sm:col-span-2"
                          }, {
                            default: withCtx(() => [
                              createVNode(_component_UTextarea, {
                                modelValue: form.description,
                                "onUpdate:modelValue": ($event) => form.description = $event,
                                placeholder: "Ticket Description",
                                rows: "6",
                                class: "min-h-32 resize-vertical",
                                maxlength: "2000"
                              }, null, 8, ["modelValue", "onUpdate:modelValue"]),
                              createVNode("p", { class: "text-xs text-muted mt-1" }, "Provide a clear, detailed description (max 2000 characters).")
                            ]),
                            _: 1
                          }),
                          createVNode(_component_UFormGroup, {
                            label: "Priority",
                            name: "priority"
                          }, {
                            default: withCtx(() => [
                              createVNode(_component_USelect, {
                                modelValue: form.priority,
                                "onUpdate:modelValue": ($event) => form.priority = $event,
                                items: priorityOptions.value,
                                placeholder: "Select priority"
                              }, null, 8, ["modelValue", "onUpdate:modelValue", "items"])
                            ]),
                            _: 1
                          }),
                          createVNode(_component_UFormGroup, {
                            label: "Category",
                            name: "category_id",
                            class: "sm:col-span-2"
                          }, {
                            default: withCtx(() => [
                              createVNode("div", { class: "relative" }, [
                                createVNode(_component_UInput, {
                                  value: categorySearch.value,
                                  placeholder: "Search categories by name",
                                  onInput: onCategoryInput,
                                  "aria-label": "Search categories"
                                }, null, 8, ["value"]),
                                categoryLoading.value ? (openBlock(), createBlock("div", {
                                  key: 0,
                                  class: "absolute right-2 top-2 text-xs text-muted"
                                }, "Searching...")) : createCommentVNode("", true),
                                categoryOptions.value.length ? (openBlock(), createBlock("ul", {
                                  key: 1,
                                  class: "absolute z-50 mt-1 w-full bg-white border rounded-md shadow-sm max-h-48 overflow-auto"
                                }, [
                                  (openBlock(true), createBlock(Fragment, null, renderList(categoryOptions.value, (opt) => {
                                    return openBlock(), createBlock("li", {
                                      key: opt.id || opt.value,
                                      class: "px-3 py-2 hover:bg-gray-100 cursor-pointer",
                                      onClick: ($event) => selectCategory(opt)
                                    }, toDisplayString(opt.name || opt.title || opt.label || opt.value), 9, ["onClick"]);
                                  }), 128))
                                ])) : categorySearch.value.length >= 2 && !categoryLoading.value ? (openBlock(), createBlock("div", {
                                  key: 2,
                                  class: "absolute z-50 mt-1 w-full bg-white border rounded-md shadow-sm px-3 py-2 text-sm text-muted"
                                }, "No matching category")) : createCommentVNode("", true),
                                selectedCategoryId.value ? (openBlock(), createBlock("div", {
                                  key: 3,
                                  class: "absolute right-2 top-2"
                                }, [
                                  createVNode("button", {
                                    type: "button",
                                    class: "text-xs text-muted hover:text-gray-700",
                                    onClick: clearCategory
                                  }, "Clear")
                                ])) : createCommentVNode("", true)
                              ]),
                              createVNode("p", { class: "text-xs text-muted mt-1" }, [
                                createTextVNode("Choose a category for the ticket. Selected: "),
                                createVNode("span", { class: "font-medium" }, toDisplayString(selectedCategoryName.value || (form.category_id ? form.category_id : "none")), 1)
                              ])
                            ]),
                            _: 1
                          }),
                          createVNode(_component_UFormGroup, {
                            label: "Attachments",
                            name: "attachments",
                            class: "sm:col-span-2"
                          }, {
                            default: withCtx(() => [
                              createVNode("div", {
                                class: ["border-2 border-dashed rounded-md p-6 min-h-28 text-center transition-colors cursor-pointer", dragActive.value ? "border-primary bg-primary/10" : "border-gray-300 bg-gray-50"],
                                onDragover: handleDragOver,
                                onDragleave: handleDragLeave,
                                onDrop: handleDrop,
                                onClick: ($event) => _ctx.$refs.fileInput.click()
                              }, [
                                createVNode("input", {
                                  ref: "fileInput",
                                  type: "file",
                                  multiple: "",
                                  class: "hidden",
                                  onChange: handleFileChange
                                }, null, 544),
                                createVNode("div", { class: "flex flex-col items-center gap-2" }, [
                                  createVNode("span", { class: "i-lucide-upload-cloud text-3xl text-primary" }),
                                  createVNode("span", { class: "font-medium" }, [
                                    createTextVNode("Drag & drop files here or "),
                                    createVNode("span", { class: "underline text-primary cursor-pointer" }, "browse")
                                  ]),
                                  createVNode("span", { class: "text-xs text-muted" }, "Max 10MB.")
                                ])
                              ], 42, ["onClick"]),
                              uploadError.value ? (openBlock(), createBlock("div", {
                                key: 0,
                                class: "mt-2 text-sm text-error"
                              }, toDisplayString(uploadError.value), 1)) : createCommentVNode("", true),
                              createVNode("div", { class: "text-xs text-muted mt-2" }, "You can attach images or PDFs. Max 10MB per file."),
                              attachments.value.length ? (openBlock(), createBlock("div", {
                                key: 1,
                                class: "mt-3"
                              }, [
                                createVNode("ul", { class: "divide-y divide-gray-200 bg-white rounded-md shadow-sm" }, [
                                  (openBlock(true), createBlock(Fragment, null, renderList(attachments.value, (file, idx) => {
                                    return openBlock(), createBlock("li", {
                                      key: file.name,
                                      class: "flex flex-col gap-2 px-3 py-2"
                                    }, [
                                      createVNode("div", { class: "flex items-center gap-2" }, [
                                        createVNode("span", { class: "i-lucide-file text-lg text-gray-400" }),
                                        createVNode("span", { class: "font-medium" }, toDisplayString(file.name), 1),
                                        createVNode("span", { class: "text-xs text-muted" }, "(" + toDisplayString((file.size / 1024 / 1024).toFixed(2)) + " MB)", 1)
                                      ]),
                                      previews.value[idx]?.type === "image" ? (openBlock(), createBlock("div", {
                                        key: 0,
                                        class: "mt-1 flex items-center"
                                      }, [
                                        createVNode("img", {
                                          src: previews.value[idx].url,
                                          alt: file.name,
                                          class: "max-h-24 rounded border"
                                        }, null, 8, ["src", "alt"])
                                      ])) : previews.value[idx]?.type === "pdf" ? (openBlock(), createBlock("div", {
                                        key: 1,
                                        class: "mt-1 flex items-center"
                                      }, [
                                        createVNode("embed", {
                                          src: previews.value[idx].url,
                                          type: "application/pdf",
                                          class: "max-h-32 w-full border rounded"
                                        }, null, 8, ["src"])
                                      ])) : previews.value[idx]?.type === "other" ? (openBlock(), createBlock("div", {
                                        key: 2,
                                        class: "mt-1 text-xs text-muted"
                                      }, " No preview available ")) : createCommentVNode("", true)
                                    ]);
                                  }), 128))
                                ])
                              ])) : createCommentVNode("", true)
                            ]),
                            _: 1
                          })
                        ]),
                        createVNode("div", { class: "flex justify-end gap-3 pt-2" }, [
                          createVNode(_component_UButton, {
                            color: "neutral",
                            variant: "ghost",
                            to: "/admin/categories"
                          }, {
                            default: withCtx(() => [
                              createTextVNode("Cancel")
                            ]),
                            _: 1
                          }),
                          createVNode(_component_UButton, {
                            loading: isSubmitting.value,
                            disabled: isSubmitting.value,
                            type: "submit",
                            color: "primary",
                            icon: "i-lucide-check"
                          }, {
                            default: withCtx(() => [
                              createTextVNode("Create")
                            ]),
                            _: 1
                          }, 8, ["loading", "disabled"])
                        ])
                      ], 32)
                    ])
                  ];
                }
              }),
              _: 1
            }, _parent2, _scopeId));
          } else {
            return [
              createVNode(_component_Sidebar),
              createVNode(_component_UDashboardPage, { class: "flex flex-col flex-1 min-w-0 overflow-hidden" }, {
                default: withCtx(() => [
                  createVNode(_component_Navbar, {
                    title: "Create ticket",
                    icon: "i-lucide-ticket-plus",
                    class: "w-full"
                  }),
                  createVNode("div", { class: "flex flex-col flex-1 gap-6 p-6 overflow-auto" }, [
                    createVNode("form", {
                      class: "flex flex-col gap-4 max-w-3xl w-full",
                      onSubmit: withModifiers(handleCreate, ["prevent"])
                    }, [
                      createVNode("div", { class: "grid grid-cols-1 gap-4 sm:grid-cols-2" }, [
                        createVNode(_component_UFormGroup, {
                          label: "Title",
                          name: "title"
                        }, {
                          default: withCtx(() => [
                            createVNode(_component_UInput, {
                              modelValue: form.title,
                              "onUpdate:modelValue": ($event) => form.title = $event,
                              placeholder: "Ticket Title",
                              required: "",
                              maxlength: "255"
                            }, null, 8, ["modelValue", "onUpdate:modelValue"])
                          ]),
                          _: 1
                        }),
                        createVNode(_component_UFormGroup, {
                          label: "Description",
                          name: "description",
                          class: "sm:col-span-2"
                        }, {
                          default: withCtx(() => [
                            createVNode(_component_UTextarea, {
                              modelValue: form.description,
                              "onUpdate:modelValue": ($event) => form.description = $event,
                              placeholder: "Ticket Description",
                              rows: "6",
                              class: "min-h-32 resize-vertical",
                              maxlength: "2000"
                            }, null, 8, ["modelValue", "onUpdate:modelValue"]),
                            createVNode("p", { class: "text-xs text-muted mt-1" }, "Provide a clear, detailed description (max 2000 characters).")
                          ]),
                          _: 1
                        }),
                        createVNode(_component_UFormGroup, {
                          label: "Priority",
                          name: "priority"
                        }, {
                          default: withCtx(() => [
                            createVNode(_component_USelect, {
                              modelValue: form.priority,
                              "onUpdate:modelValue": ($event) => form.priority = $event,
                              items: priorityOptions.value,
                              placeholder: "Select priority"
                            }, null, 8, ["modelValue", "onUpdate:modelValue", "items"])
                          ]),
                          _: 1
                        }),
                        createVNode(_component_UFormGroup, {
                          label: "Category",
                          name: "category_id",
                          class: "sm:col-span-2"
                        }, {
                          default: withCtx(() => [
                            createVNode("div", { class: "relative" }, [
                              createVNode(_component_UInput, {
                                value: categorySearch.value,
                                placeholder: "Search categories by name",
                                onInput: onCategoryInput,
                                "aria-label": "Search categories"
                              }, null, 8, ["value"]),
                              categoryLoading.value ? (openBlock(), createBlock("div", {
                                key: 0,
                                class: "absolute right-2 top-2 text-xs text-muted"
                              }, "Searching...")) : createCommentVNode("", true),
                              categoryOptions.value.length ? (openBlock(), createBlock("ul", {
                                key: 1,
                                class: "absolute z-50 mt-1 w-full bg-white border rounded-md shadow-sm max-h-48 overflow-auto"
                              }, [
                                (openBlock(true), createBlock(Fragment, null, renderList(categoryOptions.value, (opt) => {
                                  return openBlock(), createBlock("li", {
                                    key: opt.id || opt.value,
                                    class: "px-3 py-2 hover:bg-gray-100 cursor-pointer",
                                    onClick: ($event) => selectCategory(opt)
                                  }, toDisplayString(opt.name || opt.title || opt.label || opt.value), 9, ["onClick"]);
                                }), 128))
                              ])) : categorySearch.value.length >= 2 && !categoryLoading.value ? (openBlock(), createBlock("div", {
                                key: 2,
                                class: "absolute z-50 mt-1 w-full bg-white border rounded-md shadow-sm px-3 py-2 text-sm text-muted"
                              }, "No matching category")) : createCommentVNode("", true),
                              selectedCategoryId.value ? (openBlock(), createBlock("div", {
                                key: 3,
                                class: "absolute right-2 top-2"
                              }, [
                                createVNode("button", {
                                  type: "button",
                                  class: "text-xs text-muted hover:text-gray-700",
                                  onClick: clearCategory
                                }, "Clear")
                              ])) : createCommentVNode("", true)
                            ]),
                            createVNode("p", { class: "text-xs text-muted mt-1" }, [
                              createTextVNode("Choose a category for the ticket. Selected: "),
                              createVNode("span", { class: "font-medium" }, toDisplayString(selectedCategoryName.value || (form.category_id ? form.category_id : "none")), 1)
                            ])
                          ]),
                          _: 1
                        }),
                        createVNode(_component_UFormGroup, {
                          label: "Attachments",
                          name: "attachments",
                          class: "sm:col-span-2"
                        }, {
                          default: withCtx(() => [
                            createVNode("div", {
                              class: ["border-2 border-dashed rounded-md p-6 min-h-28 text-center transition-colors cursor-pointer", dragActive.value ? "border-primary bg-primary/10" : "border-gray-300 bg-gray-50"],
                              onDragover: handleDragOver,
                              onDragleave: handleDragLeave,
                              onDrop: handleDrop,
                              onClick: ($event) => _ctx.$refs.fileInput.click()
                            }, [
                              createVNode("input", {
                                ref: "fileInput",
                                type: "file",
                                multiple: "",
                                class: "hidden",
                                onChange: handleFileChange
                              }, null, 544),
                              createVNode("div", { class: "flex flex-col items-center gap-2" }, [
                                createVNode("span", { class: "i-lucide-upload-cloud text-3xl text-primary" }),
                                createVNode("span", { class: "font-medium" }, [
                                  createTextVNode("Drag & drop files here or "),
                                  createVNode("span", { class: "underline text-primary cursor-pointer" }, "browse")
                                ]),
                                createVNode("span", { class: "text-xs text-muted" }, "Max 10MB.")
                              ])
                            ], 42, ["onClick"]),
                            uploadError.value ? (openBlock(), createBlock("div", {
                              key: 0,
                              class: "mt-2 text-sm text-error"
                            }, toDisplayString(uploadError.value), 1)) : createCommentVNode("", true),
                            createVNode("div", { class: "text-xs text-muted mt-2" }, "You can attach images or PDFs. Max 10MB per file."),
                            attachments.value.length ? (openBlock(), createBlock("div", {
                              key: 1,
                              class: "mt-3"
                            }, [
                              createVNode("ul", { class: "divide-y divide-gray-200 bg-white rounded-md shadow-sm" }, [
                                (openBlock(true), createBlock(Fragment, null, renderList(attachments.value, (file, idx) => {
                                  return openBlock(), createBlock("li", {
                                    key: file.name,
                                    class: "flex flex-col gap-2 px-3 py-2"
                                  }, [
                                    createVNode("div", { class: "flex items-center gap-2" }, [
                                      createVNode("span", { class: "i-lucide-file text-lg text-gray-400" }),
                                      createVNode("span", { class: "font-medium" }, toDisplayString(file.name), 1),
                                      createVNode("span", { class: "text-xs text-muted" }, "(" + toDisplayString((file.size / 1024 / 1024).toFixed(2)) + " MB)", 1)
                                    ]),
                                    previews.value[idx]?.type === "image" ? (openBlock(), createBlock("div", {
                                      key: 0,
                                      class: "mt-1 flex items-center"
                                    }, [
                                      createVNode("img", {
                                        src: previews.value[idx].url,
                                        alt: file.name,
                                        class: "max-h-24 rounded border"
                                      }, null, 8, ["src", "alt"])
                                    ])) : previews.value[idx]?.type === "pdf" ? (openBlock(), createBlock("div", {
                                      key: 1,
                                      class: "mt-1 flex items-center"
                                    }, [
                                      createVNode("embed", {
                                        src: previews.value[idx].url,
                                        type: "application/pdf",
                                        class: "max-h-32 w-full border rounded"
                                      }, null, 8, ["src"])
                                    ])) : previews.value[idx]?.type === "other" ? (openBlock(), createBlock("div", {
                                      key: 2,
                                      class: "mt-1 text-xs text-muted"
                                    }, " No preview available ")) : createCommentVNode("", true)
                                  ]);
                                }), 128))
                              ])
                            ])) : createCommentVNode("", true)
                          ]),
                          _: 1
                        })
                      ]),
                      createVNode("div", { class: "flex justify-end gap-3 pt-2" }, [
                        createVNode(_component_UButton, {
                          color: "neutral",
                          variant: "ghost",
                          to: "/admin/categories"
                        }, {
                          default: withCtx(() => [
                            createTextVNode("Cancel")
                          ]),
                          _: 1
                        }),
                        createVNode(_component_UButton, {
                          loading: isSubmitting.value,
                          disabled: isSubmitting.value,
                          type: "submit",
                          color: "primary",
                          icon: "i-lucide-check"
                        }, {
                          default: withCtx(() => [
                            createTextVNode("Create")
                          ]),
                          _: 1
                        }, 8, ["loading", "disabled"])
                      ])
                    ], 32)
                  ])
                ]),
                _: 1
              })
            ];
          }
        }),
        _: 1
      }, _parent));
    };
  }
});
const _sfc_setup = _sfc_main.setup;
_sfc_main.setup = (props, ctx) => {
  const ssrContext = useSSRContext();
  (ssrContext.modules || (ssrContext.modules = /* @__PURE__ */ new Set())).add("pages/user/tickets/create.vue");
  return _sfc_setup ? _sfc_setup(props, ctx) : void 0;
};

export { _sfc_main as default };
//# sourceMappingURL=create-D-NvP49y.mjs.map
