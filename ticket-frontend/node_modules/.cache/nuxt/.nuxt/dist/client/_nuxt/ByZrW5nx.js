import{a0 as U}from"./GPD3P-m0.js";import{c as V}from"./Ddr_hDuZ.js";import{_ as j}from"./CvGMUJgZ.js";import{a as F}from"./B6rNHc4N.js";import{u as I}from"./RmwAmyau.js";import{g as L,z as p,e as A,l as k,Y as R,a1 as E,c as v,o as x,b as d,a as n,w as s,L as w,d as c,t as u,f as M,F as O}from"./BGim2kwq.js";const Y={class:"flex justify-end gap-2"},q={class:"flex items-center"},G={class:"flex items-center"},H={class:"mt-4 flex items-center justify-between"},J={class:"text-sm text-gray-600"},Q={key:0},W={key:1},X={class:"flex items-center gap-2"},Z={class:"px-3 text-sm"},ee=L({__name:"ticketsTable",props:{filters:{},forceStatus:{}},setup(C){const r=C,P=[{accessorKey:"id",header:"ID"},{accessorKey:"title",header:"Title"},{accessorKey:"description",header:"Description"},{accessorKey:"status",header:"Status"},{accessorKey:"priority",header:"Priority"},{accessorKey:"category.name",header:"Category"},{accessorKey:"created_at",header:"Created At"},{accessorKey:"actions",header:"Actions"}],a=p(1),i=p(20),{data:f,status:$,refresh:K}=I(()=>`tickets-page-${a.value}-${r.filters?.status||""}-${r.filters?.priority||""}-${r.filters?.category_id||""}`,()=>F({...r.filters,status:r.filters?.status??r.forceStatus,page:a.value,per_page:i.value,_raw:!0}),{watch:[()=>r.filters?.status,()=>r.filters?.priority,()=>r.filters?.category_id,()=>a.value],server:!1,lazy:!1,default:()=>null}),y=A(()=>{if(!f.value)return[];const e=f.value;return Array.isArray(e)?e:e?.data&&Array.isArray(e.data)?e.data:e?.data?.data&&Array.isArray(e.data.data)?e.data.data:Array.isArray(e.tickets)?e.tickets:[]}),g=p(0),l=p(1);k(f,e=>{if(!e){g.value=0,l.value=1;return}const t=e?.data?.meta||e?.meta||e?.pagination||e?.data||null;t&&(t.total||t.last_page||t.current_page||t.per_page)?(g.value=t.total??t.total_items??g.value,l.value=t.last_page??t.lastPage??t.total_pages??(t.total&&(t.per_page??i.value)?Math.ceil(t.total/(t.per_page??i.value)):l.value),i.value=t.per_page??t.perPage??i.value,t.current_page&&Number(t.current_page)!==a.value&&(a.value=Number(t.current_page))):(Array.isArray(e)||Array.isArray(e?.data)||Array.isArray(e?.data?.data))&&(g.value=Array.isArray(e)?e.length:Array.isArray(e.data)?e.data.length:Array.isArray(e.data?.data)?e.data.data.length:0,l.value=1)});const S=()=>{a.value>1&&a.value--},N=()=>{a.value<l.value&&a.value++},T=e=>({low:"bg-green-100 text-green-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-orange-100 text-orange-800",critical:"bg-red-100 text-red-800"})[String(e)]||"bg-gray-50 text-gray-700",z=e=>({open:"bg-green-100 text-green-800",in_progress:"bg-yellow-100 text-yellow-800",pending:"bg-orange-100 text-orange-800",resolved:"bg-blue-100 text-blue-800",closed:"bg-gray-100 text-gray-600"})[String(e)]||"bg-gray-50 text-gray-700",b=e=>e?e==="in_progress"?"In Progress":String(e).replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase()):"",_=R("user_role"),B=A(()=>_.value==="technician"?"/technician/tickets/":_.value==="supervisor"?"/supervisor/tickets/":_.value==="user"?"/user/tickets/":"/");return E(()=>{K()}),k([()=>r.filters?.status,()=>r.filters?.priority,()=>r.filters?.category_id],()=>{a.value=1}),(e,t)=>{const m=U,h=V,D=j;return x(),v(O,null,[d(D,{data:y.value,columns:P,loading:M($)==="pending"},{"actions-cell":s(({row:o})=>[n("div",Y,[d(m,{size:"xs",color:"primary",variant:"soft",icon:"i-lucide-eye",to:`${B.value}${o.original.id}`},{default:s(()=>[...t[0]||(t[0]=[c(" View ",-1)])]),_:1},8,["to"])])]),"priority-cell":s(({row:o})=>[n("div",q,[d(h,{color:"neutral",variant:"soft",class:w(`${T(o.original.priority)} px-2 py-1 text-xs font-semibold`)},{default:s(()=>[c(u(b(o.original.priority)),1)]),_:2},1032,["class"])])]),"status-cell":s(({row:o})=>[n("div",G,[d(h,{color:"neutral",variant:"soft",class:w(`${z(o.original.status)} px-2 py-1 text-xs font-semibold`)},{default:s(()=>[c(u(b(o.original.status)),1)]),_:2},1032,["class"])])]),_:1},8,["data","loading"]),n("div",H,[n("div",J,[t[1]||(t[1]=c(" Showing ",-1)),y.value.length?(x(),v("span",Q,u((a.value-1)*i.value+1)+"-"+u((a.value-1)*i.value+y.value.length),1)):(x(),v("span",W,"0")),c(" of "+u(g.value),1)]),n("div",X,[d(m,{size:"sm",variant:"ghost",disabled:a.value===1,onClick:S},{default:s(()=>[...t[2]||(t[2]=[c("Prev",-1)])]),_:1},8,["disabled"]),n("div",Z,"Page "+u(a.value)+" / "+u(l.value),1),d(m,{size:"sm",variant:"ghost",disabled:a.value===l.value,onClick:N},{default:s(()=>[...t[3]||(t[3]=[c("Next",-1)])]),_:1},8,["disabled"])])])],64)}}}),oe=Object.assign(ee,{__name:"TicketsTable"});export{oe as _};
