import{_ as y,a as b,b as C}from"./Ddr_hDuZ.js";import{_ as U}from"./D3QffkNq.js";import{a0 as k}from"./GPD3P-m0.js";import{Y as g,g as V,P as N,z as I,a4 as B,k as D,w as n,a2 as h,o as S,b as a,a as c,v as j,d as v}from"./BGim2kwq.js";import"./kDLvYEi9.js";import"./K8s1tnq0.js";const P=async({name:p,description:e,parentId:t})=>{let r=g("auth_token").value||"";try{r=decodeURIComponent(r)}catch{}const l=g("user_role").value;if(l&&!["user","technician","supervisor","admin"].includes(l))throw new Error("Invalid role. Allowed roles: user, technician, supervisor, admin");const s=await fetch("http://localhost:8000/api/categories",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({name:p,description:e,parent_category_id:t||null})}),i=await s.json();if(!s.ok)throw i;return i},R={class:"flex flex-col flex-1 gap-6 p-6 overflow-auto"},$={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},A={class:"flex justify-end gap-3 pt-2"},E=V({__name:"create",setup(p){const e=N({name:"",description:"",parentId:null}),t=I(!1),u=B(),r=async()=>{if(!t.value){t.value=!0;try{await P({name:e.name,description:e.description,parentId:e.parentId||void 0}),await u.push("/admin/categories")}catch(l){console.error("Failed to create category",l)}finally{t.value=!1}}};return(l,o)=>{const s=b,i=C,m=U,_=h("UFormGroup"),f=k,w=h("UDashboardPage"),x=y;return S(),D(x,null,{default:n(()=>[a(s),a(w,{class:"flex flex-col flex-1 min-w-0 overflow-hidden"},{default:n(()=>[a(i,{title:"Create category",icon:"i-lucide-folder-plus",class:"w-full"}),c("div",R,[c("form",{class:"flex flex-col gap-4 max-w-3xl w-full",onSubmit:j(r,["prevent"])},[c("div",$,[a(_,{label:"Name",name:"name"},{default:n(()=>[a(m,{modelValue:e.name,"onUpdate:modelValue":o[0]||(o[0]=d=>e.name=d),placeholder:"Category Name",required:"",maxlength:"255"},null,8,["modelValue"])]),_:1}),a(_,{label:"Description",name:"description"},{default:n(()=>[a(m,{modelValue:e.description,"onUpdate:modelValue":o[1]||(o[1]=d=>e.description=d),placeholder:"Category Description",maxlength:"255"},null,8,["modelValue"])]),_:1})]),c("div",A,[a(f,{color:"neutral",variant:"ghost",to:"/admin/categories"},{default:n(()=>[...o[2]||(o[2]=[v("Cancel",-1)])]),_:1}),a(f,{loading:t.value,disabled:t.value,type:"submit",color:"primary",icon:"i-lucide-check"},{default:n(()=>[...o[3]||(o[3]=[v("Create",-1)])]),_:1},8,["loading","disabled"])])],32)])]),_:1})]),_:1})}}});export{E as default};
